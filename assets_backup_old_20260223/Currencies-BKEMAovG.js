import{U as g,j as e,D as b,I as N,t as v,i as y}from"./index-BZ7L-xTc.js";import{u as h}from"./useMutation-__ySnQJG.js";import{s as u}from"./client-DBtcxyoE.js";import{C as d,a as l,b as c,c as o}from"./card-BRXMaWhS.js";import{B as C}from"./badge-B61JmWFI.js";import{T as _,a as w,b as j,c as n,d as S,e as i}from"./table-CLjY5_Yd.js";import{S as T}from"./switch-DfMiZduY.js";function q(){return y({queryKey:["currencies"],queryFn:async()=>{const{data:a,error:x}=await u.from("supported_currencies").select("*").order("code");if(x)throw x;return a??[]}})}function Q(){const{data:a,isLoading:x}=q(),m=g(),p=h({mutationFn:async({id:s,exchange_rate:t})=>{const{error:r}=await u.from("supported_currencies").update({exchange_rate:t,updated_at:new Date().toISOString()}).eq("id",s);if(r)throw r},onSuccess:()=>{m.invalidateQueries({queryKey:["currencies"]}),v({title:"Exchange rate updated"})}}),f=h({mutationFn:async({id:s,is_active:t})=>{const{error:r}=await u.from("supported_currencies").update({is_active:t}).eq("id",s);if(r)throw r},onSuccess:()=>m.invalidateQueries({queryKey:["currencies"]})});return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsxs("h1",{className:"text-2xl font-bold flex items-center gap-2",children:[e.jsx(b,{className:"h-6 w-6"})," Multi-Currency Management"]}),e.jsx("p",{className:"text-muted-foreground",children:"Manage supported currencies and exchange rates (auto-detect by region)"})]}),e.jsxs("div",{className:"grid gap-4 md:grid-cols-3",children:[e.jsxs(d,{children:[e.jsx(l,{className:"pb-2",children:e.jsx(c,{className:"text-sm font-medium text-muted-foreground",children:"Active Currencies"})}),e.jsx(o,{children:e.jsx("div",{className:"text-2xl font-bold",children:(a==null?void 0:a.filter(s=>s.is_active).length)??0})})]}),e.jsxs(d,{children:[e.jsx(l,{className:"pb-2",children:e.jsx(c,{className:"text-sm font-medium text-muted-foreground",children:"Total Currencies"})}),e.jsx(o,{children:e.jsx("div",{className:"text-2xl font-bold",children:(a==null?void 0:a.length)??0})})]}),e.jsxs(d,{children:[e.jsx(l,{className:"pb-2",children:e.jsx(c,{className:"text-sm font-medium text-muted-foreground",children:"Regions Covered"})}),e.jsx(o,{children:e.jsx("div",{className:"text-2xl font-bold",children:(a==null?void 0:a.reduce((s,t)=>s+(t.auto_detect_regions??[]).length,0))??0})})]})]}),e.jsxs(d,{children:[e.jsx(l,{children:e.jsx(c,{children:"Currencies & Exchange Rates"})}),e.jsx(o,{children:e.jsxs(_,{children:[e.jsx(w,{children:e.jsxs(j,{children:[e.jsx(n,{children:"Currency"}),e.jsx(n,{children:"Symbol"}),e.jsx(n,{children:"Exchange Rate (vs USD)"}),e.jsx(n,{children:"Auto-Detect Regions"}),e.jsx(n,{children:"Active"})]})}),e.jsx(S,{children:a==null?void 0:a.map(s=>e.jsxs(j,{children:[e.jsx(i,{children:e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold",children:s.code}),e.jsx("span",{className:"ml-2 text-sm text-muted-foreground",children:s.name})]})}),e.jsx(i,{className:"text-lg",children:s.symbol}),e.jsx(i,{children:e.jsx(N,{type:"number",step:"0.01",defaultValue:Number(s.exchange_rate),className:"w-28",onBlur:t=>{const r=parseFloat(t.target.value);r&&r!==Number(s.exchange_rate)&&p.mutate({id:s.id,exchange_rate:r})}})}),e.jsx(i,{children:e.jsx("div",{className:"flex flex-wrap gap-1",children:(s.auto_detect_regions??[]).map(t=>e.jsx(C,{variant:"outline",className:"text-xs",children:t},t))})}),e.jsx(i,{children:e.jsx(T,{checked:s.is_active??!1,onCheckedChange:t=>f.mutate({id:s.id,is_active:t})})})]},s.id))})]})})]})]})}export{Q as default};
