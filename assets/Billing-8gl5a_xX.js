import{c as re,r,Y as ie,V as R,j as e,I as p,a as i,t as a,K as D,q as ce,Z as U,e as le,N as ne}from"./index-CQF_WCmQ.js";import{S as oe}from"./SEOHead-BrGlikeS.js";import{C as y,a as f,b as N,d as _,c as g}from"./card-DVt85600.js";import{T as de,a as me,b as V,c as C,d as xe,e as w}from"./table-CEUqEhVf.js";import{B}from"./badge-DC0yH1dV.js";import{L as u}from"./label-DDQzG35B.js";import{S as pe}from"./switch-CH7W2oiL.js";import{c as h}from"./dashboard-B79BW38D.js";import{C as ue}from"./circle-alert-CBn6KQGQ.js";import{B as O}from"./bitcoin-DNrodFUB.js";import{I as he}from"./info-BhlPIiXD.js";import{L as je}from"./loader-circle-BqbY9xvb.js";import{C as ye}from"./copy-BpRSo4iN.js";import{R as fe}from"./refresh-cw-C8hyCsqh.js";/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ne=re("Euro",[["path",{d:"M4 10h12",key:"1y6xl8"}],["path",{d:"M4 14h9",key:"1loblj"}],["path",{d:"M19 6a7.7 7.7 0 0 0-5.2-2A7.9 7.9 0 0 0 6 12c0 4.4 3.5 8 7.8 8 2 0 3.8-.8 5.2-2",key:"1j6lzo"}]]),ge=.22,n=5,be={paid:"default",pending:"secondary",failed:"destructive"},ve=[{id:"btc",name:"Bitcoin (BTC)",icon:"₿",placeholder:"BTC wallet address — coming soon"},{id:"ltc",name:"Litecoin (LTC)",icon:"Ł",placeholder:"LTC wallet address — coming soon"},{id:"sol",name:"Solana (SOL)",icon:"◎",placeholder:"SOL wallet address — coming soon"},{id:"trx",name:"TRON (TRX)",icon:"⧫",placeholder:"TRX wallet address — coming soon"},{id:"bnb",name:"Binance (BNB)",icon:"♦",placeholder:"BNB wallet address — coming soon"}];function De(){const[P]=r.useState("residential"),{gateways:j,autoTopUpEnabled:$}=ie(),[k,E]=r.useState(!1),[X,q]=r.useState("50"),[z,H]=r.useState("5"),[c,L]=r.useState(null),[o,M]=r.useState("10"),[W,Y]=r.useState(""),[b,d]=r.useState(!1),{data:G}=R({queryKey:["plans"],queryFn:()=>h.getPlans()}),{data:K}=R({queryKey:["invoices"],queryFn:()=>h.getInvoices()}),m=parseFloat(o)||0,x=c==="crypto",F=x?0:m*ge,T=m+F,S=m<n,Q=s=>{a({title:"Product Selected",description:`Switching to ${s}.`})},[A,Z]=r.useState(""),[v,I]=r.useState(""),J=async()=>{if(!A||!v||!o){a({title:"Missing information",description:"Please provide currency, amount, and TXID.",variant:"destructive"});return}d(!0);try{await h.submitCrypto({currency:A,amount:parseFloat(o),txid:v}),a({title:"Submitted",description:"Your transaction has been submitted for review."}),I(""),L(null)}catch(s){a({title:"Error",description:s.message,variant:"destructive"})}finally{d(!1)}},ee=async s=>{if(E(s),s)try{const{client_secret:t}=await h.createSetupIntent();a({title:"Card setup started",description:"Please follow the instructions to save your card for auto top-up."})}catch(t){a({title:"Setup Error",description:t.message,variant:"destructive"}),E(!1)}},se=async()=>{if(S){a({title:"Minimum not met",description:`Minimum purchase is €${n}.`,variant:"destructive"});return}if(!c){a({title:"Select a payment method",description:"Please choose how you'd like to pay.",variant:"destructive"});return}if(!x)if(c==="stripe"){d(!0);try{const{url:s}=await h.createCheckout(P,parseFloat(o));window.location.href=s}catch(s){a({title:"Checkout Error",description:s.message,variant:"destructive"})}finally{d(!1)}}else a({title:`Pay with ${c}`,description:`Redirecting to ${c} checkout for €${T.toFixed(2)}...`})},te=[{id:"stripe",name:"Card (Stripe)",subtitle:"Credit/Debit Card",icon:D,vatLabel:"+22% VAT"},{id:"paypal",name:"PayPal",subtitle:"PayPal Balance",icon:ce,vatLabel:"+22% VAT"},{id:"crypto",name:"Crypto",subtitle:"BTC, LTC, SOL, TRX, BNB",icon:O,vatLabel:"No VAT"}],ae=j.stripe||j.paypal||j.crypto;return e.jsxs(e.Fragment,{children:[e.jsx(oe,{title:"Account & Billing",noindex:!0}),e.jsxs("div",{className:"space-y-6",children:[e.jsx("h1",{className:"text-2xl font-bold",children:"Account & Billing"}),e.jsxs(y,{children:[e.jsxs(f,{children:[e.jsxs(N,{className:"flex items-center gap-2 text-lg",children:[e.jsx(Ne,{className:"h-5 w-5"})," Add Balance"]}),e.jsxs(_,{children:["Minimum purchase: €",n,". 22% VAT applies to card & PayPal payments. Crypto is VAT-free."]})]}),e.jsxs(g,{className:"space-y-5",children:[e.jsxs("div",{className:"grid gap-4 sm:grid-cols-2 max-w-lg",children:[e.jsxs("div",{className:"space-y-1.5",children:[e.jsx(u,{children:"Amount (€)"}),e.jsx(p,{type:"number",value:o,onChange:s=>M(s.target.value),min:n,step:"1",placeholder:`Min €${n}`}),e.jsx("div",{className:"flex flex-wrap gap-2 mt-2",children:["10","25","50","100"].map(s=>e.jsxs(i,{variant:"outline",size:"sm",className:`text-xs h-7 px-3 ${o===s?"border-primary bg-primary/5 text-primary":""}`,onClick:()=>M(s),children:["€",s]},s))}),S&&m>0&&e.jsxs("p",{className:"text-xs text-destructive flex items-center gap-1",children:[e.jsx(ue,{className:"h-3 w-3"})," Minimum purchase is €",n]})]}),e.jsxs("div",{className:"space-y-1.5",children:[e.jsx(u,{children:"Promo Code (optional)"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(p,{placeholder:"WELCOME20",value:W,onChange:s=>Y(s.target.value)}),e.jsx(i,{variant:"outline",size:"sm",className:"shrink-0",onClick:()=>a({title:"Coupon Applied",description:"Discount applied to your balance."}),children:"Apply"})]})]})]}),!ae&&e.jsx("p",{className:"text-sm text-muted-foreground italic",children:"No payment methods are currently available. Please contact support."}),e.jsx("div",{className:"grid gap-3 sm:grid-cols-3",children:te.map(s=>{const t=j[s.id],l=c===s.id;return e.jsxs(i,{variant:l?"default":"outline",className:`h-auto py-4 flex-col gap-1 relative ${t?"":"opacity-40 cursor-not-allowed"}`,disabled:!t,onClick:()=>L(s.id),children:[e.jsx(s.icon,{className:"h-6 w-6"}),e.jsx("span",{className:"font-semibold",children:s.name}),e.jsx("span",{className:"text-[11px] font-normal opacity-80",children:s.subtitle}),e.jsx(B,{variant:s.id==="crypto"?"default":"secondary",className:"text-[10px] mt-1",children:s.vatLabel}),!t&&e.jsx("span",{className:"text-[10px] font-normal",children:"Not available"})]},s.id)})}),c&&m>=n&&e.jsxs("div",{className:"rounded-lg border bg-muted/30 p-4 max-w-sm space-y-2",children:[e.jsx("h4",{className:"text-sm font-semibold",children:"Order Summary"}),e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{children:"Subtotal"}),e.jsxs("span",{children:["€",m.toFixed(2)]})]}),e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsxs("span",{className:"flex items-center gap-1",children:["VAT (22%)",x&&e.jsx(he,{className:"h-3 w-3 text-muted-foreground"})]}),e.jsx("span",{className:x?"line-through text-muted-foreground":"",children:x?"€0.00 — exempt":`€${F.toFixed(2)}`})]}),e.jsx(U,{}),e.jsxs("div",{className:"flex justify-between text-sm font-bold",children:[e.jsx("span",{children:"Total"}),e.jsxs("span",{children:["€",T.toFixed(2)]})]}),e.jsxs(i,{className:"w-full mt-2",onClick:se,disabled:S||b,children:[b?e.jsx(je,{className:"mr-2 h-4 w-4 animate-spin"}):null,x?"Show Wallet Addresses":`Pay €${T.toFixed(2)}`]})]}),c==="crypto"&&e.jsxs(y,{className:"border-dashed",children:[e.jsxs(f,{className:"pb-2",children:[e.jsxs(N,{className:"text-sm flex items-center gap-2",children:[e.jsx(O,{className:"h-4 w-4"})," Crypto Payment — Send Exact Amount"]}),e.jsx(_,{className:"text-xs",children:"No VAT on crypto payments. Send the exact EUR-equivalent in crypto. Submitting your TXID allows an admin to verify and credit your balance."})]}),e.jsxs(g,{className:"space-y-4",children:[ve.map(s=>e.jsxs("div",{className:"flex items-center gap-3 rounded-md border p-3",children:[e.jsx("span",{className:"text-lg w-6 text-center",children:s.icon}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"text-xs font-semibold",children:s.name}),e.jsx("p",{className:"text-xs text-muted-foreground truncate",children:s.placeholder})]}),e.jsx(i,{variant:"ghost",size:"icon",className:"h-7 w-7 opacity-40",disabled:!0,children:e.jsx(ye,{className:"h-3.5 w-3.5"})})]},s.id)),e.jsx(U,{}),e.jsxs("div",{className:"space-y-3 pt-2",children:[e.jsx("h5",{className:"text-xs font-bold uppercase tracking-wider text-muted-foreground",children:"Submit Transaction"}),e.jsxs("div",{className:"grid gap-3",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx(u,{htmlFor:"crypto-curr",className:"text-[10px]",children:"Currency Used"}),e.jsx(p,{id:"crypto-curr",size:1,className:"h-8 text-xs",placeholder:"e.g. BTC, SOL",value:A,onChange:s=>Z(s.target.value)})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx(u,{htmlFor:"crypto-txid",className:"text-[10px]",children:"Transaction ID (TXID)"}),e.jsx(p,{id:"crypto-txid",className:"h-8 text-xs",placeholder:"Paste TXID here",value:v,onChange:s=>I(s.target.value)})]})]}),e.jsx(i,{className:"w-full h-9 text-xs",onClick:J,disabled:b||!v,children:b?"Submitting...":"Submit for Verification"})]})]})]})]})]}),$&&e.jsxs(y,{children:[e.jsx(f,{children:e.jsxs(N,{className:"flex items-center gap-2 text-lg",children:[e.jsx(fe,{className:"h-5 w-5"})," Auto Top-Up"]})}),e.jsxs(g,{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium",children:"Enable Auto Top-Up"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Automatically add balance when it drops below the threshold"})]}),e.jsx(pe,{checked:k,onCheckedChange:ee})]}),k&&e.jsxs("div",{className:"grid gap-4 sm:grid-cols-2",children:[e.jsxs("div",{className:"space-y-1.5",children:[e.jsx(u,{children:"Min Balance Threshold (€)"}),e.jsx(p,{type:"number",value:z,onChange:s=>H(s.target.value)})]}),e.jsxs("div",{className:"space-y-1.5",children:[e.jsx(u,{children:"Top-Up Amount (€)"}),e.jsx(p,{type:"number",value:X,onChange:s=>q(s.target.value)})]})]})]})]}),e.jsx("div",{className:"grid gap-4 sm:grid-cols-3",children:(G||[]).map(s=>{const t=s.id===P;return e.jsxs(y,{className:t?"border-primary ring-2 ring-primary/20":"",children:[e.jsx(f,{className:"pb-2",children:e.jsxs(N,{className:"flex items-center justify-between text-lg",children:[s.name,t&&e.jsx(B,{children:"Active"})]})}),e.jsxs(g,{className:"space-y-4",children:[e.jsxs("p",{className:"text-3xl font-bold",children:["€",(s.price_cents/100).toFixed(2),e.jsxs("span",{className:"text-base font-normal text-muted-foreground",children:["/",(s.id==="datacenter","GB")]})]}),e.jsx("ul",{className:"space-y-1.5",children:s.features.map(l=>e.jsxs("li",{className:"flex items-start gap-2 text-sm text-muted-foreground",children:[e.jsx(le,{className:"mt-0.5 h-4 w-4 shrink-0 text-primary"}),l]},l))}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(i,{variant:t?"outline":"default",className:"w-full",disabled:t,onClick:()=>Q(s.id),children:t?"Active Product":"Select Product"}),!t&&j.stripe&&e.jsxs(i,{variant:"secondary",className:"w-full gap-2",onClick:async()=>{d(!0);try{const{url:l}=await h.createProductCheckout(s.id,1);window.location.href=l}catch(l){a({title:"Purchase Error",description:l.message,variant:"destructive"})}finally{d(!1)}},children:[e.jsx(D,{className:"h-4 w-4"})," Buy Now"]})]})]})]},s.id)})}),e.jsxs(y,{children:[e.jsx(f,{children:e.jsx(N,{className:"text-lg",children:"Recent Invoices"})}),e.jsx(g,{className:"p-0",children:e.jsxs(de,{children:[e.jsx(me,{children:e.jsxs(V,{children:[e.jsx(C,{children:"Period"}),e.jsx(C,{children:"Amount"}),e.jsx(C,{children:"Status"}),e.jsx(C,{className:"text-right",children:"Date"})]})}),e.jsx(xe,{children:(K||[]).map(s=>e.jsxs(V,{children:[e.jsx(w,{className:"font-medium",children:s.period}),e.jsxs(w,{children:["€",(s.amount_cents/100).toFixed(2)]}),e.jsx(w,{children:e.jsx(B,{variant:be[s.status]??"secondary",children:s.status})}),e.jsxs(w,{className:"text-right text-sm text-muted-foreground space-x-2",children:[e.jsx("span",{children:new Date(s.created_at).toLocaleDateString()}),s.pdf_url&&e.jsx(i,{variant:"ghost",size:"icon",className:"h-7 w-7",asChild:!0,title:"Download PDF",children:e.jsx("a",{href:s.pdf_url,target:"_blank",rel:"noopener noreferrer",children:e.jsx(ne,{className:"h-3.5 w-3.5"})})})]})]},s.id))})]})})]})]})]})}export{De as default};
