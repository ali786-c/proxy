import{c as I,m as A,U as L,r as C,j as e,G as z,a as c,I as B,y as R,z as X,E as F,J as H,K as l,t as m,i as K}from"./index-D5UIMIAT.js";import{u as N}from"./useMutation-CgtBru7h.js";import{s as j}from"./client-DBtcxyoE.js";import{C as D,a as b,b as _,d as M,c as w}from"./card-rwfYRBA5.js";import{L as S}from"./label-DoNXWbzT.js";import{B as t}from"./badge-0xpZ6sgU.js";import{T as Q,a as U,b as p,c as o,d as V,e as n}from"./table-CfANce93.js";import{D as G,a as O,b as J,c as W,d as Y}from"./dialog-Da7lSGWi.js";import{P as $}from"./plus-DtZkDa9d.js";import{C as y}from"./clock-CLoIM6ZV.js";import{C as P}from"./circle-check-big-C12IAiZ-.js";import{C as Z}from"./copy-DCSw29_6.js";import{T as ee}from"./trash-2-BE4dTh-0.js";/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const se=I("CircleX",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]),T={active:{variant:"default",icon:P},issuing:{variant:"outline",icon:y},pending:{variant:"secondary",icon:y},failed:{variant:"destructive",icon:se}};function ae(){const{user:i}=A();return K({queryKey:["custom-domains",i==null?void 0:i.id],enabled:!!(i!=null&&i.id),queryFn:async()=>{const{data:r,error:x}=await j.from("custom_proxy_domains").select("*").eq("user_id",i.id).order("created_at",{ascending:!1});if(x)throw x;return r??[]}})}function je(){const{user:i}=A(),{data:r,isLoading:x}=ae(),f=L(),[k,g]=C.useState(!1),[d,h]=C.useState({domain:"",proxy_type:"residential"}),u=N({mutationFn:async()=>{const s=`uproxy-verify-${crypto.randomUUID().slice(0,12)}`,{error:a}=await j.from("custom_proxy_domains").insert({user_id:i.id,domain:d.domain,proxy_type:d.proxy_type,dns_txt_record:s});if(a)throw a},onSuccess:()=>{f.invalidateQueries({queryKey:["custom-domains"]}),m({title:"Domain added! Configure DNS to complete setup."}),g(!1),h({domain:"",proxy_type:"residential"})},onError:s=>m({title:"Error",description:s.message,variant:"destructive"})}),q=N({mutationFn:async s=>{const{error:a}=await j.from("custom_proxy_domains").delete().eq("id",s);if(a)throw a},onSuccess:()=>{f.invalidateQueries({queryKey:["custom-domains"]}),m({title:"Domain removed"})}}),E=s=>{navigator.clipboard.writeText(s),m({title:"Copied to clipboard"})};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs("h1",{className:"text-2xl font-bold flex items-center gap-2",children:[e.jsx(z,{className:"h-6 w-6"})," Custom Proxy Domains"]}),e.jsx("p",{className:"text-muted-foreground",children:"Use your own domain for proxy endpoints"})]}),e.jsxs(G,{open:k,onOpenChange:g,children:[e.jsx(O,{asChild:!0,children:e.jsxs(c,{children:[e.jsx($,{className:"mr-2 h-4 w-4"}),"Add Domain"]})}),e.jsxs(J,{children:[e.jsx(W,{children:e.jsx(Y,{children:"Add Custom Proxy Domain"})}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(S,{children:"Domain"}),e.jsx(B,{placeholder:"proxy.yourdomain.com",value:d.domain,onChange:s=>h(a=>({...a,domain:s.target.value}))})]}),e.jsxs("div",{children:[e.jsx(S,{children:"Proxy Type"}),e.jsxs(R,{value:d.proxy_type,onValueChange:s=>h(a=>({...a,proxy_type:s})),children:[e.jsx(X,{children:e.jsx(F,{})}),e.jsxs(H,{children:[e.jsx(l,{value:"residential",children:"Residential"}),e.jsx(l,{value:"datacenter",children:"Datacenter"}),e.jsx(l,{value:"mobile",children:"Mobile"}),e.jsx(l,{value:"isp",children:"ISP"})]})]})]}),e.jsx(c,{onClick:()=>u.mutate(),disabled:u.isPending||!d.domain,className:"w-full",children:u.isPending?"Adding…":"Add Domain"})]})]})]})]}),e.jsxs(D,{children:[e.jsxs(b,{children:[e.jsx(_,{children:"DNS Setup Instructions"}),e.jsx(M,{children:"Add a CNAME record pointing your domain to our proxy endpoint, then add the TXT record to verify ownership."})]}),e.jsx(w,{children:e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx(t,{variant:"outline",children:"1"}),e.jsxs("span",{children:["Add a ",e.jsx("code",{className:"bg-muted px-1 rounded",children:"CNAME"})," record: ",e.jsx("code",{className:"bg-muted px-1 rounded",children:"proxy.yourdomain.com → endpoint.upgraderproxy.com"})]})]}),e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx(t,{variant:"outline",children:"2"}),e.jsxs("span",{children:["Add a ",e.jsx("code",{className:"bg-muted px-1 rounded",children:"TXT"})," record with the verification value shown below"]})]}),e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx(t,{variant:"outline",children:"3"}),e.jsx("span",{children:"Wait for DNS propagation and SSL provisioning (up to 24 hours)"})]})]})})]}),e.jsxs(D,{children:[e.jsx(b,{children:e.jsx(_,{children:"Your Domains"})}),e.jsx(w,{children:e.jsxs(Q,{children:[e.jsx(U,{children:e.jsxs(p,{children:[e.jsx(o,{children:"Domain"}),e.jsx(o,{children:"Proxy Type"}),e.jsx(o,{children:"DNS Verified"}),e.jsx(o,{children:"SSL Status"}),e.jsx(o,{children:"TXT Record"}),e.jsx(o,{children:"Actions"})]})}),e.jsxs(V,{children:[r==null?void 0:r.map(s=>{var v;const a=T[s.ssl_status]??T.pending;return e.jsxs(p,{children:[e.jsx(n,{className:"font-medium",children:s.domain}),e.jsx(n,{className:"capitalize",children:s.proxy_type}),e.jsx(n,{children:s.dns_verified?e.jsxs(t,{variant:"default",children:[e.jsx(P,{className:"mr-1 h-3 w-3"}),"Verified"]}):e.jsxs(t,{variant:"secondary",children:[e.jsx(y,{className:"mr-1 h-3 w-3"}),"Pending"]})}),e.jsx(n,{children:e.jsxs(t,{variant:a.variant,children:[e.jsx(a.icon,{className:"mr-1 h-3 w-3"}),s.ssl_status]})}),e.jsx(n,{children:e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsxs("code",{className:"bg-muted px-1 rounded text-xs",children:[(v=s.dns_txt_record)==null?void 0:v.slice(0,20),"…"]}),e.jsx(c,{size:"icon",variant:"ghost",className:"h-6 w-6",onClick:()=>E(s.dns_txt_record??""),children:e.jsx(Z,{className:"h-3 w-3"})})]})}),e.jsx(n,{children:e.jsx(c,{size:"icon",variant:"ghost",className:"h-8 w-8 text-destructive",onClick:()=>q.mutate(s.id),children:e.jsx(ee,{className:"h-4 w-4"})})})]},s.id)}),!(r!=null&&r.length)&&e.jsx(p,{children:e.jsx(n,{colSpan:6,className:"text-center text-muted-foreground py-8",children:"No custom domains configured"})})]})]})})]})]})}export{je as default};
