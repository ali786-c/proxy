import{U as E,r as d,i as Q,j as e,D as A,a as C,I as r,t as f,ae as u}from"./index-D5UIMIAT.js";import{u as p}from"./useMutation-CgtBru7h.js";import{C as b,a as S,b as w,c as R}from"./card-rwfYRBA5.js";import{B as n}from"./badge-0xpZ6sgU.js";import{T as K,a as U,b as T,c as i,d as H,e as c}from"./table-CfANce93.js";import{S as M}from"./switch-JzKzOiW_.js";import{S as k}from"./SEOHead-D-mAupIa.js";import{R as L}from"./refresh-cw-DKiEgoqK.js";import{P}from"./plus-DtZkDa9d.js";function Y(){const l=E(),[o,j]=d.useState(""),[m,g]=d.useState(""),[x,y]=d.useState(""),[h,v]=d.useState("1.0"),{data:_=[],isLoading:q}=Q({queryKey:["admin-currencies"],queryFn:()=>u.get("/admin/currencies",s=>s)}),N=p({mutationFn:s=>u.post("/admin/currencies",a=>a,s),onSuccess:()=>{l.invalidateQueries({queryKey:["admin-currencies"]}),j(""),g(""),y(""),v("1.0"),f({title:"Currency added"})}}),D=p({mutationFn:({id:s,exchange_rate:a})=>u.put(`/admin/currencies/${s}`,t=>t,{exchange_rate:a}),onSuccess:()=>{l.invalidateQueries({queryKey:["admin-currencies"]}),f({title:"Exchange rate updated"})}}),F=p({mutationFn:s=>u.post(`/admin/currencies/${s}/toggle`,a=>a,{}),onSuccess:()=>{l.invalidateQueries({queryKey:["admin-currencies"]})}}),B=s=>{s.preventDefault(),!(!o||!m||!x||!h)&&N.mutate({code:o.toUpperCase(),name:m,symbol:x,exchange_rate:parseFloat(h),is_active:!0})};return q?e.jsx("div",{className:"p-8 text-center text-muted-foreground",children:"Loading currencies..."}):e.jsxs(e.Fragment,{children:[e.jsx(k,{title:"Admin — Currencies",noindex:!0}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsxs("h1",{className:"text-2xl font-bold flex items-center gap-2",children:[e.jsx(A,{className:"h-6 w-6"})," Currencies"]}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Manage supported currencies and exchange rates."})]}),e.jsxs("div",{className:"grid gap-6 md:grid-cols-3",children:[e.jsxs(b,{className:"md:col-span-2",children:[e.jsxs(S,{className:"flex flex-row items-center justify-between",children:[e.jsx(w,{children:"Supported Currencies"}),e.jsxs(C,{variant:"outline",size:"sm",onClick:()=>l.invalidateQueries({queryKey:["admin-currencies"]}),children:[e.jsx(L,{className:"mr-2 h-4 w-4"})," Refresh"]})]}),e.jsx(R,{children:e.jsxs(K,{children:[e.jsx(U,{children:e.jsxs(T,{children:[e.jsx(i,{children:"Code"}),e.jsx(i,{children:"Symbol"}),e.jsx(i,{className:"text-right",children:"Rate (vs USD)"}),e.jsx(i,{children:"Status"}),e.jsx(i,{})]})}),e.jsx(H,{children:_.map(s=>e.jsxs(T,{children:[e.jsxs(c,{children:[e.jsx("span",{className:"font-bold",children:s.code}),e.jsx("span",{className:"ml-2 text-xs text-muted-foreground",children:s.name})]}),e.jsx(c,{className:"text-lg",children:s.symbol}),e.jsx(c,{className:"text-right",children:e.jsx(r,{type:"number",step:"0.0001",defaultValue:s.exchange_rate,className:"w-24 ml-auto h-8 text-right px-2",onBlur:a=>{const t=parseFloat(a.target.value);t&&t!==s.exchange_rate&&D.mutate({id:s.id,exchange_rate:t})}})}),e.jsx(c,{children:e.jsx(n,{variant:s.is_active?"default":"secondary",children:s.is_active?"Active":"Disabled"})}),e.jsx(c,{children:e.jsx(M,{checked:s.is_active,onCheckedChange:()=>F.mutate(s.id)})})]},s.id))})]})})]}),e.jsxs(b,{children:[e.jsx(S,{children:e.jsx(w,{children:"Add New Currency"})}),e.jsx(R,{children:e.jsxs("form",{onSubmit:B,className:"space-y-4",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx(n,{variant:"outline",className:"text-[10px] uppercase",children:"Currency Code"}),e.jsx(r,{placeholder:"EUR",value:o,onChange:s=>j(s.target.value),maxLength:3})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx(n,{variant:"outline",className:"text-[10px] uppercase",children:"Display Name"}),e.jsx(r,{placeholder:"Euro",value:m,onChange:s=>g(s.target.value)})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx(n,{variant:"outline",className:"text-[10px] uppercase",children:"Symbol"}),e.jsx(r,{placeholder:"€",value:x,onChange:s=>y(s.target.value)})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx(n,{variant:"outline",className:"text-[10px] uppercase",children:"Rate (Base USD)"}),e.jsx(r,{type:"number",step:"0.0001",value:h,onChange:s=>v(s.target.value)})]})]}),e.jsxs(C,{type:"submit",className:"w-full",disabled:N.isPending,children:[e.jsx(P,{className:"mr-2 h-4 w-4"})," Add Currency"]})]})})]})]})]})]})}export{Y as default};
