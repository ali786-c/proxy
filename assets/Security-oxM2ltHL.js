import{c as He,r as t,j as e,ac as X,S as $e,a as $,f as Ge,t as G,I as be}from"./index-BZ7L-xTc.js";import{S as ze}from"./SEOHead-YcYDGI9H.js";import{C as se,a as le,b as oe,d as Ue,c as ie}from"./card-BRXMaWhS.js";import{B as ye}from"./badge-B61JmWFI.js";import{L as Ce}from"./label-DfEVn6Py.js";import{h as Ve}from"./use-backend-UtYrQSpY.js";import{C as qe}from"./copy-CdkJ2nAn.js";import{L as Qe}from"./loader-circle-DYqaV7b_.js";import"./useMutation-__ySnQJG.js";import"./dashboard-CJNzIvyN.js";/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ze=He("Dot",[["circle",{cx:"12.1",cy:"12.1",r:"1",key:"18d7e5"}]]);var Je=Object.defineProperty,Ke=Object.defineProperties,Xe=Object.getOwnPropertyDescriptors,Y=Object.getOwnPropertySymbols,Pe=Object.prototype.hasOwnProperty,Ee=Object.prototype.propertyIsEnumerable,Se=(a,n,s)=>n in a?Je(a,n,{enumerable:!0,configurable:!0,writable:!0,value:s}):a[n]=s,Ye=(a,n)=>{for(var s in n||(n={}))Pe.call(n,s)&&Se(a,s,n[s]);if(Y)for(var s of Y(n))Ee.call(n,s)&&Se(a,s,n[s]);return a},et=(a,n)=>Ke(a,Xe(n)),tt=(a,n)=>{var s={};for(var o in a)Pe.call(a,o)&&n.indexOf(o)<0&&(s[o]=a[o]);if(a!=null&&Y)for(var o of Y(a))n.indexOf(o)<0&&Ee.call(a,o)&&(s[o]=a[o]);return s};function nt(a){let n=setTimeout(a,0),s=setTimeout(a,10),o=setTimeout(a,50);return[n,s,o]}function rt(a){let n=t.useRef();return t.useEffect(()=>{n.current=a}),n.current}var at=18,Ne=40,st=`${Ne}px`,lt=["[data-lastpass-icon-root]","com-1password-button","[data-dashlanecreated]",'[style$="2147483647 !important;"]'].join(",");function ot({containerRef:a,inputRef:n,pushPasswordManagerStrategy:s,isFocused:o}){let[v,c]=t.useState(!1),[y,j]=t.useState(!1),[E,M]=t.useState(!1),O=t.useMemo(()=>s==="none"?!1:(s==="increase-width"||s==="experimental-no-flickering")&&v&&y,[v,y,s]),N=t.useCallback(()=>{let m=a.current,k=n.current;if(!m||!k||E||s==="none")return;let w=m,S=w.getBoundingClientRect().left+w.offsetWidth,L=w.getBoundingClientRect().top+w.offsetHeight/2,u=S-at,z=L;document.querySelectorAll(lt).length===0&&document.elementFromPoint(u,z)===m||(c(!0),M(!0))},[a,n,E,s]);return t.useEffect(()=>{let m=a.current;if(!m||s==="none")return;function k(){let S=window.innerWidth-m.getBoundingClientRect().right;j(S>=Ne)}k();let w=setInterval(k,1e3);return()=>{clearInterval(w)}},[a,s]),t.useEffect(()=>{let m=o||document.activeElement===n.current;if(s==="none"||!m)return;let k=setTimeout(N,0),w=setTimeout(N,2e3),S=setTimeout(N,5e3),L=setTimeout(()=>{M(!0)},6e3);return()=>{clearTimeout(k),clearTimeout(w),clearTimeout(S),clearTimeout(L)}},[n,o,s,N]),{hasPWMBadge:v,willPushPWMBadge:O,PWM_BADGE_SPACE_WIDTH:st}}var ke=t.createContext({}),Te=t.forwardRef((a,n)=>{var s=a,{value:o,onChange:v,maxLength:c,textAlign:y="left",pattern:j,placeholder:E,inputMode:M="numeric",onComplete:O,pushPasswordManagerStrategy:N="increase-width",pasteTransformer:m,containerClassName:k,noScriptCSSFallback:w=it,render:S,children:L}=s,u=tt(s,["value","onChange","maxLength","textAlign","pattern","placeholder","inputMode","onComplete","pushPasswordManagerStrategy","pasteTransformer","containerClassName","noScriptCSSFallback","render","children"]),z,ce,ue,de,pe;let[Oe,Re]=t.useState(typeof u.defaultValue=="string"?u.defaultValue:""),d=o??Oe,R=rt(d),U=t.useCallback(r=>{v==null||v(r),Re(r)},[v]),C=t.useMemo(()=>j?typeof j=="string"?new RegExp(j):j:null,[j]),p=t.useRef(null),ee=t.useRef(null),te=t.useRef({value:d,onChange:U,isIOS:typeof window<"u"&&((ce=(z=window==null?void 0:window.CSS)==null?void 0:z.supports)==null?void 0:ce.call(z,"-webkit-touch-callout","none"))}),J=t.useRef({prev:[(ue=p.current)==null?void 0:ue.selectionStart,(de=p.current)==null?void 0:de.selectionEnd,(pe=p.current)==null?void 0:pe.selectionDirection]});t.useImperativeHandle(n,()=>p.current,[]),t.useEffect(()=>{let r=p.current,l=ee.current;if(!r||!l)return;te.current.value!==r.value&&te.current.onChange(r.value),J.current.prev=[r.selectionStart,r.selectionEnd,r.selectionDirection];function h(){if(document.activeElement!==r){q(null),Q(null);return}let i=r.selectionStart,f=r.selectionEnd,K=r.selectionDirection,b=r.maxLength,D=r.value,P=J.current.prev,T=-1,A=-1,B;if(D.length!==0&&i!==null&&f!==null){let We=i===f,Le=i===D.length&&D.length<b;if(We&&!Le){let F=i;if(F===0)T=0,A=1,B="forward";else if(F===b)T=F-1,A=F,B="backward";else if(b>1&&D.length>1){let ae=0;if(P[0]!==null&&P[1]!==null){B=F<P[1]?"backward":"forward";let _e=P[0]===P[1]&&P[0]<b;B==="backward"&&!_e&&(ae=-1)}T=ae+F,A=ae+F+1}}T!==-1&&A!==-1&&T!==A&&p.current.setSelectionRange(T,A,B)}let je=T!==-1?T:i,we=A!==-1?A:f,Fe=B??K;q(je),Q(we),J.current.prev=[je,we,Fe]}if(document.addEventListener("selectionchange",h,{capture:!0}),h(),document.activeElement===r&&ne(!0),!document.getElementById("input-otp-style")){let i=document.createElement("style");if(i.id="input-otp-style",document.head.appendChild(i),i.sheet){let f="background: transparent !important; color: transparent !important; border-color: transparent !important; opacity: 0 !important; box-shadow: none !important; -webkit-box-shadow: none !important; -webkit-text-fill-color: transparent !important;";Z(i.sheet,"[data-input-otp]::selection { background: transparent !important; color: transparent !important; }"),Z(i.sheet,`[data-input-otp]:autofill { ${f} }`),Z(i.sheet,`[data-input-otp]:-webkit-autofill { ${f} }`),Z(i.sheet,"@supports (-webkit-touch-callout: none) { [data-input-otp] { letter-spacing: -.6em !important; font-weight: 100 !important; font-stretch: ultra-condensed; font-optical-sizing: none !important; left: -1px !important; right: 1px !important; } }"),Z(i.sheet,"[data-input-otp] + * { pointer-events: all !important; }")}}let x=()=>{l&&l.style.setProperty("--root-height",`${r.clientHeight}px`)};x();let g=new ResizeObserver(x);return g.observe(r),()=>{document.removeEventListener("selectionchange",h,{capture:!0}),g.disconnect()}},[]);let[me,he]=t.useState(!1),[V,ne]=t.useState(!1),[I,q]=t.useState(null),[_,Q]=t.useState(null);t.useEffect(()=>{nt(()=>{var r,l,h,x;(r=p.current)==null||r.dispatchEvent(new Event("input"));let g=(l=p.current)==null?void 0:l.selectionStart,i=(h=p.current)==null?void 0:h.selectionEnd,f=(x=p.current)==null?void 0:x.selectionDirection;g!==null&&i!==null&&(q(g),Q(i),J.current.prev=[g,i,f])})},[d,V]),t.useEffect(()=>{R!==void 0&&d!==R&&R.length<c&&d.length===c&&(O==null||O(d))},[c,O,R,d]);let H=ot({containerRef:ee,inputRef:p,pushPasswordManagerStrategy:N,isFocused:V}),fe=t.useCallback(r=>{let l=r.currentTarget.value.slice(0,c);if(l.length>0&&C&&!C.test(l)){r.preventDefault();return}typeof R=="string"&&l.length<R.length&&document.dispatchEvent(new Event("selectionchange")),U(l)},[c,U,R,C]),ve=t.useCallback(()=>{var r;if(p.current){let l=Math.min(p.current.value.length,c-1),h=p.current.value.length;(r=p.current)==null||r.setSelectionRange(l,h),q(l),Q(h)}ne(!0)},[c]),xe=t.useCallback(r=>{var l,h;let x=p.current;if(!m&&(!te.current.isIOS||!r.clipboardData||!x))return;let g=r.clipboardData.getData("text/plain"),i=m?m(g):g;r.preventDefault();let f=(l=p.current)==null?void 0:l.selectionStart,K=(h=p.current)==null?void 0:h.selectionEnd,b=(f!==K?d.slice(0,f)+i+d.slice(K):d.slice(0,f)+i+d.slice(f)).slice(0,c);if(b.length>0&&C&&!C.test(b))return;x.value=b,U(b);let D=Math.min(b.length,c-1),P=b.length;x.setSelectionRange(D,P),q(D),Q(P)},[c,U,C,d]),Ie=t.useMemo(()=>({position:"relative",cursor:u.disabled?"default":"text",userSelect:"none",WebkitUserSelect:"none",pointerEvents:"none"}),[u.disabled]),ge=t.useMemo(()=>({position:"absolute",inset:0,width:H.willPushPWMBadge?`calc(100% + ${H.PWM_BADGE_SPACE_WIDTH})`:"100%",clipPath:H.willPushPWMBadge?`inset(0 ${H.PWM_BADGE_SPACE_WIDTH} 0 0)`:void 0,height:"100%",display:"flex",textAlign:y,opacity:"1",color:"transparent",pointerEvents:"all",background:"transparent",caretColor:"transparent",border:"0 solid transparent",outline:"0 solid transparent",boxShadow:"none",lineHeight:"1",letterSpacing:"-.5em",fontSize:"var(--root-height)",fontFamily:"monospace",fontVariantNumeric:"tabular-nums"}),[H.PWM_BADGE_SPACE_WIDTH,H.willPushPWMBadge,y]),De=t.useMemo(()=>t.createElement("input",et(Ye({autoComplete:u.autoComplete||"one-time-code"},u),{"data-input-otp":!0,"data-input-otp-placeholder-shown":d.length===0||void 0,"data-input-otp-mss":I,"data-input-otp-mse":_,inputMode:M,pattern:C==null?void 0:C.source,"aria-placeholder":E,style:ge,maxLength:c,value:d,ref:p,onPaste:r=>{var l;xe(r),(l=u.onPaste)==null||l.call(u,r)},onChange:fe,onMouseOver:r=>{var l;he(!0),(l=u.onMouseOver)==null||l.call(u,r)},onMouseLeave:r=>{var l;he(!1),(l=u.onMouseLeave)==null||l.call(u,r)},onFocus:r=>{var l;ve(),(l=u.onFocus)==null||l.call(u,r)},onBlur:r=>{var l;ne(!1),(l=u.onBlur)==null||l.call(u,r)}})),[fe,ve,xe,M,ge,c,_,I,u,C==null?void 0:C.source,d]),re=t.useMemo(()=>({slots:Array.from({length:c}).map((r,l)=>{var h;let x=V&&I!==null&&_!==null&&(I===_&&l===I||l>=I&&l<_),g=d[l]!==void 0?d[l]:null,i=d[0]!==void 0?null:(h=E==null?void 0:E[l])!=null?h:null;return{char:g,placeholderChar:i,isActive:x,hasFakeCaret:x&&g===null}}),isFocused:V,isHovering:!u.disabled&&me}),[V,me,c,_,I,u.disabled,d]),Be=t.useMemo(()=>S?S(re):t.createElement(ke.Provider,{value:re},L),[L,re,S]);return t.createElement(t.Fragment,null,w!==null&&t.createElement("noscript",null,t.createElement("style",null,w)),t.createElement("div",{ref:ee,"data-input-otp-container":!0,style:Ie,className:k},Be,t.createElement("div",{style:{position:"absolute",inset:0,pointerEvents:"none"}},De)))});Te.displayName="Input";function Z(a,n){try{a.insertRule(n)}catch{console.error("input-otp could not insert CSS rule:",n)}}var it=`
[data-input-otp] {
  --nojs-bg: white !important;
  --nojs-fg: black !important;

  background-color: var(--nojs-bg) !important;
  color: var(--nojs-fg) !important;
  caret-color: var(--nojs-fg) !important;
  letter-spacing: .25em !important;
  text-align: center !important;
  border: 1px solid var(--nojs-fg) !important;
  border-radius: 4px !important;
  width: 100% !important;
}
@media (prefers-color-scheme: dark) {
  [data-input-otp] {
    --nojs-bg: black !important;
    --nojs-fg: white !important;
  }
}`;const Ae=t.forwardRef(({className:a,containerClassName:n,...s},o)=>e.jsx(Te,{ref:o,containerClassName:X("flex items-center gap-2 has-[:disabled]:opacity-50",n),className:X("disabled:cursor-not-allowed",a),...s}));Ae.displayName="InputOTP";const Me=t.forwardRef(({className:a,...n},s)=>e.jsx("div",{ref:s,className:X("flex items-center",a),...n}));Me.displayName="InputOTPGroup";const W=t.forwardRef(({index:a,className:n,...s},o)=>{const v=t.useContext(ke),{char:c,hasFakeCaret:y,isActive:j}=v.slots[a];return e.jsxs("div",{ref:o,className:X("relative flex h-10 w-10 items-center justify-center border-y border-r border-input text-sm transition-all first:rounded-l-md first:border-l last:rounded-r-md",j&&"z-10 ring-2 ring-ring ring-offset-background",n),...s,children:[c,y&&e.jsx("div",{className:"pointer-events-none absolute inset-0 flex items-center justify-center",children:e.jsx("div",{className:"animate-caret-blink h-4 w-px bg-foreground duration-1000"})})]})});W.displayName="InputOTPSlot";const ct=t.forwardRef(({...a},n)=>e.jsx("div",{ref:n,role:"separator",...a,children:e.jsx(Ze,{})}));ct.displayName="InputOTPSeparator";function wt(){const a=Ve(),[n,s]=t.useState(""),[o,v]=t.useState(""),[c,y]=t.useState(!1),j=async()=>{if(!n||n!==o){G({title:"Validation Error",description:"Passwords do not match.",variant:"destructive"});return}y(!0);try{await a.mutateAsync({password:n,password_confirmation:o}),G({title:"Password updated successfully"}),s(""),v("")}catch(m){G({title:"Error",description:m.message,variant:"destructive"})}finally{y(!1)}},E={mutate:()=>G({title:"2FA Setup",description:"This feature is coming soon to the self-hosted version."})},M=!1,O=()=>{if(otpCode.length!==6){G({title:"Invalid code",description:"Enter a 6-digit code",variant:"destructive"});return}E.mutate()},N=`otpauth://totp/UpgradedProxy:${user==null?void 0:user.email}?secret=${mockSecret}&issuer=UpgradedProxy`;return e.jsxs(e.Fragment,{children:[e.jsx(ze,{title:"Security & 2FA",noindex:!0}),e.jsxs("div",{className:"space-y-6",children:[e.jsx("h1",{className:"text-2xl font-bold",children:"Security & 2FA"}),e.jsxs(se,{children:[e.jsx(le,{children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx($e,{className:"h-8 w-8 text-muted-foreground"}),e.jsxs("div",{children:[e.jsx(oe,{className:"text-lg",children:"Two-Factor Authentication (TOTP)"}),e.jsx(Ue,{children:"Add an extra layer of security using an authenticator app like Google Authenticator or Authy."})]}),e.jsx(ye,{variant:"secondary",className:"ml-auto",children:"Disabled"})]})}),e.jsxs(ie,{className:"space-y-4",children:[M,step==="idle"&&e.jsxs($,{onClick:()=>setStep("setup"),children:[e.jsx(Ge,{className:"mr-2 h-4 w-4"})," Enable 2FA"]}),step==="setup"&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("p",{className:"text-sm font-medium",children:"1. Scan this QR code with your authenticator app:"}),e.jsx("div",{className:"flex items-center justify-center rounded-lg border bg-white p-6",style:{maxWidth:240},children:e.jsx("img",{src:`https://api.qrserver.com/v1/create-qr-code/?size=200x200&data=${encodeURIComponent(N)}`,alt:"2FA QR Code",className:"w-48 h-48"})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("p",{className:"text-sm font-medium",children:"Or enter this secret manually:"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("code",{className:"bg-muted px-3 py-1.5 rounded text-sm font-mono",children:mockSecret}),e.jsx($,{variant:"ghost",size:"icon",onClick:()=>{navigator.clipboard.writeText(mockSecret),G({title:"Copied"})},children:e.jsx(qe,{className:"h-4 w-4"})})]})]}),e.jsx($,{onClick:()=>setStep("verify"),children:"Next: Verify Code"})]}),step==="verify"&&e.jsxs("div",{className:"space-y-4",children:[e.jsx("p",{className:"text-sm font-medium",children:"2. Enter the 6-digit code from your authenticator app:"}),e.jsx(Ae,{maxLength:6,value:otpCode,onChange:setOtpCode,children:e.jsxs(Me,{children:[e.jsx(W,{index:0}),e.jsx(W,{index:1}),e.jsx(W,{index:2}),e.jsx(W,{index:3}),e.jsx(W,{index:4}),e.jsx(W,{index:5})]})}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx($,{variant:"outline",onClick:()=>{setStep("setup"),setOtpCode("")},children:"Back"}),e.jsx($,{onClick:O,disabled:otpCode.length!==6,children:"Verify & Enable"})]})]})]})]}),e.jsxs(se,{children:[e.jsx(le,{children:e.jsx(oe,{className:"text-lg",children:"Change Password"})}),e.jsxs(ie,{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2 max-w-sm",children:[e.jsx(Ce,{children:"New Password"}),e.jsx(be,{type:"password",placeholder:"••••••••",value:n,onChange:m=>s(m.target.value)})]}),e.jsxs("div",{className:"space-y-2 max-w-sm",children:[e.jsx(Ce,{children:"Confirm New Password"}),e.jsx(be,{type:"password",placeholder:"••••••••",value:o,onChange:m=>v(m.target.value)})]}),e.jsxs($,{onClick:j,disabled:c,children:[c?e.jsx(Qe,{className:"mr-2 h-4 w-4 animate-spin"}):null,"Update Password"]})]})]}),e.jsxs(se,{children:[e.jsx(le,{children:e.jsx(oe,{className:"text-lg",children:"Active Sessions"})}),e.jsx(ie,{children:e.jsxs("div",{className:"flex items-center justify-between rounded-lg border p-3",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium",children:"Current Session"}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:["Browser • ",navigator.userAgent.split(" ").pop()]})]}),e.jsx(ye,{variant:"default",children:"Active"})]})})]})]})]})}export{wt as default};
