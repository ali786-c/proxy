import{c as Z,r as n,_ as J,Z as M,j as e,I as p,a as o,t as r,O as _,w as X,k as S,$ as ee,e as se,i as d,P as te}from"./index-BeYWUc0b.js";import{S as ae}from"./SEOHead-pmtGgQ8x.js";import{C as j,a as y,b as f,d as re,c as g}from"./card-B5UOakCf.js";import{T as ie,a as le,b as F,c as N,d as ce,e as v}from"./table-DgkavPbA.js";import{L as b}from"./label-BtEyUhVW.js";import{S as ne}from"./switch-BgZO59oF.js";import{C as oe}from"./circle-alert-DccaKeJj.js";import{B as U}from"./bitcoin-DrvmMSe_.js";import{I as de}from"./info-QH7aUZIE.js";import{L as me}from"./loader-circle-C6EZ6HXl.js";import{R as ue}from"./refresh-cw-Nh6yolQO.js";/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xe=Z("Euro",[["path",{d:"M4 10h12",key:"1y6xl8"}],["path",{d:"M4 14h9",key:"1loblj"}],["path",{d:"M19 6a7.7 7.7 0 0 0-5.2-2A7.9 7.9 0 0 0 6 12c0 4.4 3.5 8 7.8 8 2 0 3.8-.8 5.2-2",key:"1j6lzo"}]]),he=.22,m=5,pe={paid:"default",pending:"secondary",failed:"destructive"};function Te(){const[T]=n.useState("residential"),{gateways:u,autoTopUpEnabled:I}=J(),[P,k]=n.useState(!1),[L,D]=n.useState("50"),[R,$]=n.useState("5"),[i,V]=n.useState(null),[C,E]=n.useState("10"),[H,O]=n.useState(""),[x,l]=n.useState(!1),{data:q}=M({queryKey:["plans"],queryFn:()=>d.getPlans()}),{data:z}=M({queryKey:["invoices"],queryFn:()=>d.getInvoices()}),c=parseFloat(C)||0,h=i==="cryptomus",B=h?0:c*he,w=c+B,A=c<m,G=s=>{r({title:"Product Selected",description:`Switching to ${s}.`})},K=async s=>{if(k(s),s)try{const{client_secret:t}=await d.createSetupIntent();r({title:"Card setup started",description:"Please follow the instructions to save your card for auto top-up."})}catch(t){r({title:"Setup Error",description:t.message,variant:"destructive"}),k(!1)}},W=async()=>{if(A){r({title:"Minimum not met",description:`Minimum purchase is €${m}.`,variant:"destructive"});return}if(!i){r({title:"Select a payment method",description:"Please choose how you'd like to pay.",variant:"destructive"});return}if(i==="cryptomus"){l(!0);try{const{url:s}=await d.createCryptomusCheckout(c);window.location.href=s}catch(s){r({title:"Checkout Error",description:s.message,variant:"destructive"})}finally{l(!1)}}else if(i==="stripe"){l(!0);try{const{url:s}=await d.createCheckout(T,c);window.location.href=s}catch(s){r({title:"Checkout Error",description:s.message,variant:"destructive"})}finally{l(!1)}}else r({title:`Pay with ${i}`,description:`Redirecting to ${i} checkout for €${w.toFixed(2)}...`})},Q=[{id:"stripe",name:"Card (Stripe)",subtitle:"Credit/Debit Card",icon:_,vatLabel:"+22% VAT"},{id:"paypal",name:"PayPal",subtitle:"PayPal Balance",icon:X,vatLabel:"+22% VAT"},{id:"cryptomus",name:"Crypto",subtitle:"Automated via Cryptomus",icon:U,vatLabel:"No VAT"}],Y=u.stripe||u.paypal||u.cryptomus;return e.jsxs(e.Fragment,{children:[e.jsx(ae,{title:"Account & Billing",noindex:!0}),e.jsxs("div",{className:"space-y-6",children:[e.jsx("h1",{className:"text-2xl font-bold",children:"Account & Billing"}),e.jsxs(j,{children:[e.jsxs(y,{children:[e.jsxs(f,{className:"flex items-center gap-2 text-lg",children:[e.jsx(xe,{className:"h-5 w-5"})," Add Balance"]}),e.jsxs(re,{children:["Minimum purchase: €",m,". 22% VAT applies to card & PayPal payments. Crypto is VAT-free."]})]}),e.jsxs(g,{className:"space-y-5",children:[e.jsxs("div",{className:"grid gap-4 sm:grid-cols-2 max-w-lg",children:[e.jsxs("div",{className:"space-y-1.5",children:[e.jsx(b,{children:"Amount (€)"}),e.jsx(p,{type:"number",value:C,onChange:s=>E(s.target.value),min:m,step:"1",placeholder:`Min €${m}`}),e.jsx("div",{className:"flex flex-wrap gap-2 mt-2",children:["10","25","50","100"].map(s=>e.jsxs(o,{variant:"outline",size:"sm",className:`text-xs h-7 px-3 ${C===s?"border-primary bg-primary/5 text-primary":""}`,onClick:()=>E(s),children:["€",s]},s))}),A&&c>0&&e.jsxs("p",{className:"text-xs text-destructive flex items-center gap-1",children:[e.jsx(oe,{className:"h-3 w-3"})," Minimum purchase is €",m]})]}),e.jsxs("div",{className:"space-y-1.5",children:[e.jsx(b,{children:"Promo Code (optional)"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(p,{placeholder:"WELCOME20",value:H,onChange:s=>O(s.target.value)}),e.jsx(o,{variant:"outline",size:"sm",className:"shrink-0",onClick:()=>r({title:"Coupon Applied",description:"Discount applied to your balance."}),children:"Apply"})]})]})]}),!Y&&e.jsx("p",{className:"text-sm text-muted-foreground italic",children:"No payment methods are currently available. Please contact support."}),e.jsx("div",{className:"grid gap-3 sm:grid-cols-3",children:Q.map(s=>{const t=u[s.id],a=i===s.id;return e.jsxs(o,{variant:a?"default":"outline",className:`h-auto py-4 flex-col gap-1 relative ${t?"":"opacity-40 cursor-not-allowed"}`,disabled:!t,onClick:()=>V(s.id),children:[e.jsx(s.icon,{className:"h-6 w-6"}),e.jsx("span",{className:"font-semibold",children:s.name}),e.jsx("span",{className:"text-[11px] font-normal opacity-80",children:s.subtitle}),e.jsx(S,{variant:s.id==="crypto"?"default":"secondary",className:"text-[10px] mt-1",children:s.vatLabel}),!t&&e.jsx("span",{className:"text-[10px] font-normal",children:"Not available"})]},s.id)})}),i&&c>=m&&e.jsxs("div",{className:"rounded-lg border bg-muted/30 p-4 max-w-sm space-y-2",children:[e.jsx("h4",{className:"text-sm font-semibold",children:"Order Summary"}),e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{children:"Subtotal"}),e.jsxs("span",{children:["€",c.toFixed(2)]})]}),e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsxs("span",{className:"flex items-center gap-1",children:["VAT (22%)",h&&e.jsx(de,{className:"h-3 w-3 text-muted-foreground"})]}),e.jsx("span",{className:h?"line-through text-muted-foreground":"",children:h?"€0.00 — exempt":`€${B.toFixed(2)}`})]}),e.jsx(ee,{}),e.jsxs("div",{className:"flex justify-between text-sm font-bold",children:[e.jsx("span",{children:"Total"}),e.jsxs("span",{children:["€",w.toFixed(2)]})]}),e.jsxs(o,{className:"w-full mt-2",onClick:W,disabled:A||x,children:[x?e.jsx(me,{className:"mr-2 h-4 w-4 animate-spin"}):null,"Pay €",w.toFixed(2)]})]})]})]}),I&&e.jsxs(j,{children:[e.jsx(y,{children:e.jsxs(f,{className:"flex items-center gap-2 text-lg",children:[e.jsx(ue,{className:"h-5 w-5"})," Auto Top-Up"]})}),e.jsxs(g,{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium",children:"Enable Auto Top-Up"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Automatically add balance when it drops below the threshold"})]}),e.jsx(ne,{checked:P,onCheckedChange:K})]}),P&&e.jsxs("div",{className:"grid gap-4 sm:grid-cols-2",children:[e.jsxs("div",{className:"space-y-1.5",children:[e.jsx(b,{children:"Min Balance Threshold (€)"}),e.jsx(p,{type:"number",value:R,onChange:s=>$(s.target.value)})]}),e.jsxs("div",{className:"space-y-1.5",children:[e.jsx(b,{children:"Top-Up Amount (€)"}),e.jsx(p,{type:"number",value:L,onChange:s=>D(s.target.value)})]})]})]})]}),e.jsx("div",{className:"grid gap-4 sm:grid-cols-3",children:(q||[]).map(s=>{const t=s.id===T;return e.jsxs(j,{className:t?"border-primary ring-2 ring-primary/20":"",children:[e.jsx(y,{className:"pb-2",children:e.jsxs(f,{className:"flex items-center justify-between text-lg",children:[s.name,t&&e.jsx(S,{children:"Active"})]})}),e.jsxs(g,{className:"space-y-4",children:[e.jsxs("p",{className:"text-3xl font-bold",children:["€",(s.price_cents/100).toFixed(2),e.jsxs("span",{className:"text-base font-normal text-muted-foreground",children:["/",(s.id==="datacenter","GB")]})]}),e.jsx("ul",{className:"space-y-1.5",children:s.features.map(a=>e.jsxs("li",{className:"flex items-start gap-2 text-sm text-muted-foreground",children:[e.jsx(se,{className:"mt-0.5 h-4 w-4 shrink-0 text-primary"}),a]},a))}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(o,{variant:t?"outline":"default",className:"w-full",disabled:t,onClick:()=>G(s.id),children:t?"Active Product":"Select Product"}),!t&&e.jsxs("div",{className:"flex flex-col gap-2",children:[u.stripe&&e.jsxs(o,{variant:"secondary",className:"w-full gap-2",disabled:x,onClick:async()=>{l(!0);try{const{url:a}=await d.createProductCheckout(s.id,1);window.location.href=a}catch(a){r({title:"Purchase Error",description:a.message,variant:"destructive"})}finally{l(!1)}},children:[e.jsx(_,{className:"h-4 w-4"})," Buy with Card"]}),u.cryptomus&&e.jsxs(o,{variant:"outline",className:"w-full gap-2 border-primary/20 hover:border-primary/50",disabled:x,onClick:async()=>{l(!0);try{const{url:a}=await d.createCryptomusProductCheckout(s.id,1);window.location.href=a}catch(a){r({title:"Purchase Error",description:a.message,variant:"destructive"})}finally{l(!1)}},children:[e.jsx(U,{className:"h-4 w-4 text-orange-500"})," Buy with Crypto"]})]})]})]})]},s.id)})}),e.jsxs(j,{children:[e.jsx(y,{children:e.jsx(f,{className:"text-lg",children:"Recent Invoices"})}),e.jsx(g,{className:"p-0",children:e.jsxs(ie,{children:[e.jsx(le,{children:e.jsxs(F,{children:[e.jsx(N,{children:"Period"}),e.jsx(N,{children:"Amount"}),e.jsx(N,{children:"Status"}),e.jsx(N,{className:"text-right",children:"Date"})]})}),e.jsx(ce,{children:(z||[]).map(s=>e.jsxs(F,{children:[e.jsx(v,{className:"font-medium",children:s.period}),e.jsxs(v,{children:["€",(s.amount_cents/100).toFixed(2)]}),e.jsx(v,{children:e.jsx(S,{variant:pe[s.status]??"secondary",children:s.status})}),e.jsxs(v,{className:"text-right text-sm text-muted-foreground space-x-2",children:[e.jsx("span",{children:new Date(s.created_at).toLocaleDateString()}),s.pdf_url&&e.jsx(o,{variant:"ghost",size:"icon",className:"h-7 w-7",asChild:!0,title:"Download PDF",children:e.jsx("a",{href:s.pdf_url,target:"_blank",rel:"noopener noreferrer",children:e.jsx(te,{className:"h-3.5 w-3.5"})})})]})]},s.id))})]})})]})]})]})}export{Te as default};
