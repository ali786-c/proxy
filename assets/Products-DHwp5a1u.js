import{c as D,r as u,j as e,B as d,I as h,q as v,v as g,w as y,x as f,y as c,t as o}from"./index-CZjjzW98.js";import{S as M}from"./SEOHead-BQntEyAM.js";import{C as N,c as _}from"./card-B5Gfyd7p.js";import{L as l}from"./label-C7s9DKkj.js";import{B as G}from"./badge-BpWL1baF.js";import{S as L}from"./switch-BFF6T-Qc.js";import{D as O,b as R,c as z,d as U,e as H}from"./dialog-DxFlqzkX.js";import{T as V,a as q,b as P,c as r,d as K,e as i}from"./table-s1GjQ5ZU.js";import{p as Y}from"./use-backend-C-fVTGhT.js";import{P as J}from"./plus-B7Txo7Wn.js";import{T as Q}from"./trash-2-D9uuJSeo.js";import"./useQuery-CPO4fHLH.js";import"./useMutation-DDTMDbh5.js";import"./api-BTF2QDx4.js";/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const W=D("Pencil",[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}],["path",{d:"m15 5 4 4",key:"1mk7zo"}]]),b={name:"",proxy_type:"residential",unit:"GB",base_cost_eur:"",markup_pct:"30",is_active:!0};function xe(){const{data:C,isLoading:S,createProduct:k,updateProduct:T,deleteProduct:B}=Y(),[A,n]=u.useState(!1),[x,p]=u.useState(null),[a,t]=u.useState(b);if(S)return e.jsx("div",{className:"p-8 text-center text-muted-foreground",children:"Loading products…"});const w=()=>{p(null),t(b),n(!0)},E=s=>{p(s.id),t({name:s.name,proxy_type:s.type,unit:"GB",base_cost_eur:String(s.price*.7),markup_pct:"30",is_active:s.is_active!==!1}),n(!0)},j=()=>{const s=parseFloat(a.base_cost_eur)||0,m=parseFloat(a.markup_pct)||0;return(s*(1+m/100)).toFixed(2)},F=async()=>{try{const s={name:a.name,type:a.proxy_type,price:parseFloat(j()),evomi_product_id:"TBD",is_active:a.is_active};x?(await T.mutateAsync({id:x,...s}),o({title:"Product updated"})):(await k.mutateAsync(s),o({title:"Product created"})),n(!1)}catch(s){o({title:"Error",description:s.message,variant:"destructive"})}},I=async s=>{if(confirm("Are you sure?"))try{await B.mutateAsync(s),o({title:"Product deleted"})}catch(m){o({title:"Error",description:m.message,variant:"destructive"})}};return e.jsxs(e.Fragment,{children:[e.jsx(M,{title:"Admin — Products",noindex:!0}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold",children:"Products"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Manage proxy product catalog. All prices flat-rate in EUR with 30% markup over base cost."})]}),e.jsxs(d,{onClick:w,children:[e.jsx(J,{className:"mr-2 h-4 w-4"})," Add Product"]})]}),e.jsx(N,{children:e.jsx(_,{className:"p-0",children:e.jsxs(V,{children:[e.jsx(q,{children:e.jsxs(P,{children:[e.jsx(r,{children:"Product"}),e.jsx(r,{children:"Type"}),e.jsx(r,{children:"Unit"}),e.jsx(r,{className:"text-right",children:"Base Cost"}),e.jsx(r,{className:"text-right",children:"Markup"}),e.jsx(r,{className:"text-right",children:"Sell Price"}),e.jsx(r,{children:"Status"}),e.jsx(r,{})]})}),e.jsx(K,{children:(C??[]).map(s=>e.jsxs(P,{children:[e.jsx(i,{className:"font-medium",children:s.name}),e.jsx(i,{className:"capitalize",children:s.type}),e.jsx(i,{children:"per GB"}),e.jsxs(i,{className:"text-right",children:["€",(s.price*.7).toFixed(2)]}),e.jsx(i,{className:"text-right",children:"30%"}),e.jsxs(i,{className:"text-right font-semibold",children:["€",Number(s.price).toFixed(2),"/GB"]}),e.jsx(i,{children:e.jsx(G,{variant:s.is_active!==!1?"default":"secondary",children:s.is_active!==!1?"Active":"Inactive"})}),e.jsx(i,{children:e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(d,{variant:"ghost",size:"icon",onClick:()=>E(s),children:e.jsx(W,{className:"h-4 w-4"})}),e.jsx(d,{variant:"ghost",size:"icon",onClick:()=>I(s.id),children:e.jsx(Q,{className:"h-4 w-4 text-destructive"})})]})})]},s.id))})]})})}),e.jsx(N,{children:e.jsxs(_,{className:"py-4",children:[e.jsx("p",{className:"text-sm font-medium",children:"Pricing Model"}),e.jsx("p",{className:"mt-1 text-xs text-muted-foreground",children:"All products use flat-rate pricing in EUR. The sell price = base cost × (1 + markup%). Same price for all customers regardless of volume — no tiers, no volume discounts."})]})})]}),e.jsx(O,{open:A,onOpenChange:n,children:e.jsxs(R,{children:[e.jsx(z,{children:e.jsx(U,{children:x?"Edit Product":"Create Product"})}),e.jsxs("div",{className:"space-y-4 py-2",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx(l,{children:"Name"}),e.jsx(h,{value:a.name,onChange:s=>t({...a,name:s.target.value})})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx(l,{children:"Proxy Type"}),e.jsxs(v,{value:a.proxy_type,onValueChange:s=>t({...a,proxy_type:s}),children:[e.jsx(g,{children:e.jsx(y,{})}),e.jsxs(f,{children:[e.jsx(c,{value:"residential",children:"Residential"}),e.jsx(c,{value:"datacenter",children:"Datacenter"}),e.jsx(c,{value:"isp",children:"ISP"}),e.jsx(c,{value:"mobile",children:"Mobile"}),e.jsx(c,{value:"socks5",children:"SOCKS5"})]})]})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx(l,{children:"Billing Unit"}),e.jsxs(v,{value:a.unit,onValueChange:s=>t({...a,unit:s}),children:[e.jsx(g,{children:e.jsx(y,{})}),e.jsxs(f,{children:[e.jsx(c,{value:"GB",children:"Per GB"}),e.jsx(c,{value:"IP",children:"Per IP"})]})]})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx(l,{children:"Base Cost (€)"}),e.jsx(h,{type:"number",step:"0.01",value:a.base_cost_eur,onChange:s=>t({...a,base_cost_eur:s.target.value})})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx(l,{children:"Markup (%)"}),e.jsx(h,{type:"number",value:a.markup_pct,onChange:s=>t({...a,markup_pct:s.target.value})})]})]}),e.jsx("div",{className:"rounded-md bg-muted/50 p-3",children:e.jsxs("p",{className:"text-sm",children:["Sell Price: ",e.jsxs("span",{className:"font-bold text-primary",children:["€",j(),"/",a.unit]})]})}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(L,{checked:a.is_active,onCheckedChange:s=>t({...a,is_active:s})}),e.jsx(l,{children:"Active"})]})]}),e.jsxs(H,{children:[e.jsx(d,{variant:"outline",onClick:()=>n(!1),children:"Cancel"}),e.jsx(d,{onClick:F,children:x?"Update":"Create"})]})]})})]})}export{xe as default};
