import{c as qe,r as t,j as e,$ as ee,h as ze,ab as Ge,S as Qe,B as T,t as z,e as Ve,I as ye}from"./index-C0xZJzrY.js";import{S as Ue}from"./SEOHead-BLxs91Wc.js";import{C as X,a as ie,b as oe,d as Ke,c as Z}from"./card-CIZLDzlC.js";import{B as we}from"./badge-B3Z4cfMG.js";import{L as Ce}from"./label-BPvoMbvf.js";import{u as Ye}from"./useQuery-C3Yn-xZv.js";import{u as Se}from"./useMutation-BbtBGJL9.js";import{S as Je}from"./shield-check-DtYIrlQd.js";import{E as Xe}from"./eye-off-DqpMdaY7.js";import{E as Ze}from"./eye-CEg_bl37.js";import{C as Ne}from"./copy-CrWSgA55.js";/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const et=qe("Dot",[["circle",{cx:"12.1",cy:"12.1",r:"1",key:"18d7e5"}]]);var tt=Object.defineProperty,nt=Object.defineProperties,at=Object.getOwnPropertyDescriptors,te=Object.getOwnPropertySymbols,ke=Object.prototype.hasOwnProperty,Pe=Object.prototype.propertyIsEnumerable,Ee=(n,r,s)=>r in n?tt(n,r,{enumerable:!0,configurable:!0,writable:!0,value:s}):n[r]=s,rt=(n,r)=>{for(var s in r||(r={}))ke.call(r,s)&&Ee(n,s,r[s]);if(te)for(var s of te(r))Pe.call(r,s)&&Ee(n,s,r[s]);return n},st=(n,r)=>nt(n,at(r)),lt=(n,r)=>{var s={};for(var i in n)ke.call(n,i)&&r.indexOf(i)<0&&(s[i]=n[i]);if(n!=null&&te)for(var i of te(n))r.indexOf(i)<0&&Pe.call(n,i)&&(s[i]=n[i]);return s};function it(n){let r=setTimeout(n,0),s=setTimeout(n,10),i=setTimeout(n,50);return[r,s,i]}function ot(n){let r=t.useRef();return t.useEffect(()=>{r.current=n}),r.current}var ct=18,Te=40,ut=`${Te}px`,dt=["[data-lastpass-icon-root]","com-1password-button","[data-dashlanecreated]",'[style$="2147483647 !important;"]'].join(",");function pt({containerRef:n,inputRef:r,pushPasswordManagerStrategy:s,isFocused:i}){let[v,u]=t.useState(!1),[j,w]=t.useState(!1),[N,L]=t.useState(!1),f=t.useMemo(()=>s==="none"?!1:(s==="increase-width"||s==="experimental-no-flickering")&&v&&j,[v,j,s]),R=t.useCallback(()=>{let x=n.current,E=r.current;if(!x||!E||N||s==="none")return;let m=x,C=m.getBoundingClientRect().left+m.offsetWidth,A=m.getBoundingClientRect().top+m.offsetHeight/2,o=C-ct,B=A;document.querySelectorAll(dt).length===0&&document.elementFromPoint(o,B)===x||(u(!0),L(!0))},[n,r,N,s]);return t.useEffect(()=>{let x=n.current;if(!x||s==="none")return;function E(){let C=window.innerWidth-x.getBoundingClientRect().right;w(C>=Te)}E();let m=setInterval(E,1e3);return()=>{clearInterval(m)}},[n,s]),t.useEffect(()=>{let x=i||document.activeElement===r.current;if(s==="none"||!x)return;let E=setTimeout(R,0),m=setTimeout(R,2e3),C=setTimeout(R,5e3),A=setTimeout(()=>{L(!0)},6e3);return()=>{clearTimeout(E),clearTimeout(m),clearTimeout(C),clearTimeout(A)}},[r,i,s,R]),{hasPWMBadge:v,willPushPWMBadge:f,PWM_BADGE_SPACE_WIDTH:ut}}var Ae=t.createContext({}),Me=t.forwardRef((n,r)=>{var s=n,{value:i,onChange:v,maxLength:u,textAlign:j="left",pattern:w,placeholder:N,inputMode:L="numeric",onComplete:f,pushPasswordManagerStrategy:R="increase-width",pasteTransformer:x,containerClassName:E,noScriptCSSFallback:m=mt,render:C,children:A}=s,o=lt(s,["value","onChange","maxLength","textAlign","pattern","placeholder","inputMode","onComplete","pushPasswordManagerStrategy","pasteTransformer","containerClassName","noScriptCSSFallback","render","children"]),B,ce,ue,de,pe;let[Be,Fe]=t.useState(typeof o.defaultValue=="string"?o.defaultValue:""),d=i??Be,F=ot(d),G=t.useCallback(a=>{v==null||v(a),Fe(a)},[v]),k=t.useMemo(()=>w?typeof w=="string"?new RegExp(w):w:null,[w]),p=t.useRef(null),ne=t.useRef(null),ae=t.useRef({value:d,onChange:G,isIOS:typeof window<"u"&&((ce=(B=window==null?void 0:window.CSS)==null?void 0:B.supports)==null?void 0:ce.call(B,"-webkit-touch-callout","none"))}),Y=t.useRef({prev:[(ue=p.current)==null?void 0:ue.selectionStart,(de=p.current)==null?void 0:de.selectionEnd,(pe=p.current)==null?void 0:pe.selectionDirection]});t.useImperativeHandle(r,()=>p.current,[]),t.useEffect(()=>{let a=p.current,l=ne.current;if(!a||!l)return;ae.current.value!==a.value&&ae.current.onChange(a.value),Y.current.prev=[a.selectionStart,a.selectionEnd,a.selectionDirection];function h(){if(document.activeElement!==a){V(null),U(null);return}let c=a.selectionStart,g=a.selectionEnd,J=a.selectionDirection,S=a.maxLength,D=a.value,P=Y.current.prev,M=-1,O=-1,W;if(D.length!==0&&c!==null&&g!==null){let He=c===g,Le=c===D.length&&D.length<S;if(He&&!Le){let _=c;if(_===0)M=0,O=1,W="forward";else if(_===S)M=_-1,O=_,W="backward";else if(S>1&&D.length>1){let le=0;if(P[0]!==null&&P[1]!==null){W=_<P[1]?"backward":"forward";let $e=P[0]===P[1]&&P[0]<S;W==="backward"&&!$e&&(le=-1)}M=le+_,O=le+_+1}}M!==-1&&O!==-1&&M!==O&&p.current.setSelectionRange(M,O,W)}let je=M!==-1?M:c,be=O!==-1?O:g,_e=W??J;V(je),U(be),Y.current.prev=[je,be,_e]}if(document.addEventListener("selectionchange",h,{capture:!0}),h(),document.activeElement===a&&re(!0),!document.getElementById("input-otp-style")){let c=document.createElement("style");if(c.id="input-otp-style",document.head.appendChild(c),c.sheet){let g="background: transparent !important; color: transparent !important; border-color: transparent !important; opacity: 0 !important; box-shadow: none !important; -webkit-box-shadow: none !important; -webkit-text-fill-color: transparent !important;";K(c.sheet,"[data-input-otp]::selection { background: transparent !important; color: transparent !important; }"),K(c.sheet,`[data-input-otp]:autofill { ${g} }`),K(c.sheet,`[data-input-otp]:-webkit-autofill { ${g} }`),K(c.sheet,"@supports (-webkit-touch-callout: none) { [data-input-otp] { letter-spacing: -.6em !important; font-weight: 100 !important; font-stretch: ultra-condensed; font-optical-sizing: none !important; left: -1px !important; right: 1px !important; } }"),K(c.sheet,"[data-input-otp] + * { pointer-events: all !important; }")}}let b=()=>{l&&l.style.setProperty("--root-height",`${a.clientHeight}px`)};b();let y=new ResizeObserver(b);return y.observe(a),()=>{document.removeEventListener("selectionchange",h,{capture:!0}),y.disconnect()}},[]);let[me,he]=t.useState(!1),[Q,re]=t.useState(!1),[I,V]=t.useState(null),[$,U]=t.useState(null);t.useEffect(()=>{it(()=>{var a,l,h,b;(a=p.current)==null||a.dispatchEvent(new Event("input"));let y=(l=p.current)==null?void 0:l.selectionStart,c=(h=p.current)==null?void 0:h.selectionEnd,g=(b=p.current)==null?void 0:b.selectionDirection;y!==null&&c!==null&&(V(y),U(c),Y.current.prev=[y,c,g])})},[d,Q]),t.useEffect(()=>{F!==void 0&&d!==F&&F.length<u&&d.length===u&&(f==null||f(d))},[u,f,F,d]);let q=pt({containerRef:ne,inputRef:p,pushPasswordManagerStrategy:R,isFocused:Q}),fe=t.useCallback(a=>{let l=a.currentTarget.value.slice(0,u);if(l.length>0&&k&&!k.test(l)){a.preventDefault();return}typeof F=="string"&&l.length<F.length&&document.dispatchEvent(new Event("selectionchange")),G(l)},[u,G,F,k]),xe=t.useCallback(()=>{var a;if(p.current){let l=Math.min(p.current.value.length,u-1),h=p.current.value.length;(a=p.current)==null||a.setSelectionRange(l,h),V(l),U(h)}re(!0)},[u]),ve=t.useCallback(a=>{var l,h;let b=p.current;if(!x&&(!ae.current.isIOS||!a.clipboardData||!b))return;let y=a.clipboardData.getData("text/plain"),c=x?x(y):y;a.preventDefault();let g=(l=p.current)==null?void 0:l.selectionStart,J=(h=p.current)==null?void 0:h.selectionEnd,S=(g!==J?d.slice(0,g)+c+d.slice(J):d.slice(0,g)+c+d.slice(g)).slice(0,u);if(S.length>0&&k&&!k.test(S))return;b.value=S,G(S);let D=Math.min(S.length,u-1),P=S.length;b.setSelectionRange(D,P),V(D),U(P)},[u,G,k,d]),Ie=t.useMemo(()=>({position:"relative",cursor:o.disabled?"default":"text",userSelect:"none",WebkitUserSelect:"none",pointerEvents:"none"}),[o.disabled]),ge=t.useMemo(()=>({position:"absolute",inset:0,width:q.willPushPWMBadge?`calc(100% + ${q.PWM_BADGE_SPACE_WIDTH})`:"100%",clipPath:q.willPushPWMBadge?`inset(0 ${q.PWM_BADGE_SPACE_WIDTH} 0 0)`:void 0,height:"100%",display:"flex",textAlign:j,opacity:"1",color:"transparent",pointerEvents:"all",background:"transparent",caretColor:"transparent",border:"0 solid transparent",outline:"0 solid transparent",boxShadow:"none",lineHeight:"1",letterSpacing:"-.5em",fontSize:"var(--root-height)",fontFamily:"monospace",fontVariantNumeric:"tabular-nums"}),[q.PWM_BADGE_SPACE_WIDTH,q.willPushPWMBadge,j]),De=t.useMemo(()=>t.createElement("input",st(rt({autoComplete:o.autoComplete||"one-time-code"},o),{"data-input-otp":!0,"data-input-otp-placeholder-shown":d.length===0||void 0,"data-input-otp-mss":I,"data-input-otp-mse":$,inputMode:L,pattern:k==null?void 0:k.source,"aria-placeholder":N,style:ge,maxLength:u,value:d,ref:p,onPaste:a=>{var l;ve(a),(l=o.onPaste)==null||l.call(o,a)},onChange:fe,onMouseOver:a=>{var l;he(!0),(l=o.onMouseOver)==null||l.call(o,a)},onMouseLeave:a=>{var l;he(!1),(l=o.onMouseLeave)==null||l.call(o,a)},onFocus:a=>{var l;xe(),(l=o.onFocus)==null||l.call(o,a)},onBlur:a=>{var l;re(!1),(l=o.onBlur)==null||l.call(o,a)}})),[fe,xe,ve,L,ge,u,$,I,o,k==null?void 0:k.source,d]),se=t.useMemo(()=>({slots:Array.from({length:u}).map((a,l)=>{var h;let b=Q&&I!==null&&$!==null&&(I===$&&l===I||l>=I&&l<$),y=d[l]!==void 0?d[l]:null,c=d[0]!==void 0?null:(h=N==null?void 0:N[l])!=null?h:null;return{char:y,placeholderChar:c,isActive:b,hasFakeCaret:b&&y===null}}),isFocused:Q,isHovering:!o.disabled&&me}),[Q,me,u,$,I,o.disabled,d]),We=t.useMemo(()=>C?C(se):t.createElement(Ae.Provider,{value:se},A),[A,se,C]);return t.createElement(t.Fragment,null,m!==null&&t.createElement("noscript",null,t.createElement("style",null,m)),t.createElement("div",{ref:ne,"data-input-otp-container":!0,style:Ie,className:E},We,t.createElement("div",{style:{position:"absolute",inset:0,pointerEvents:"none"}},De)))});Me.displayName="Input";function K(n,r){try{n.insertRule(r)}catch{console.error("input-otp could not insert CSS rule:",r)}}var mt=`
[data-input-otp] {
  --nojs-bg: white !important;
  --nojs-fg: black !important;

  background-color: var(--nojs-bg) !important;
  color: var(--nojs-fg) !important;
  caret-color: var(--nojs-fg) !important;
  letter-spacing: .25em !important;
  text-align: center !important;
  border: 1px solid var(--nojs-fg) !important;
  border-radius: 4px !important;
  width: 100% !important;
}
@media (prefers-color-scheme: dark) {
  [data-input-otp] {
    --nojs-bg: black !important;
    --nojs-fg: white !important;
  }
}`;const Oe=t.forwardRef(({className:n,containerClassName:r,...s},i)=>e.jsx(Me,{ref:i,containerClassName:ee("flex items-center gap-2 has-[:disabled]:opacity-50",r),className:ee("disabled:cursor-not-allowed",n),...s}));Oe.displayName="InputOTP";const Re=t.forwardRef(({className:n,...r},s)=>e.jsx("div",{ref:s,className:ee("flex items-center",n),...r}));Re.displayName="InputOTPGroup";const H=t.forwardRef(({index:n,className:r,...s},i)=>{const v=t.useContext(Ae),{char:u,hasFakeCaret:j,isActive:w}=v.slots[n];return e.jsxs("div",{ref:i,className:ee("relative flex h-10 w-10 items-center justify-center border-y border-r border-input text-sm transition-all first:rounded-l-md first:border-l last:rounded-r-md",w&&"z-10 ring-2 ring-ring ring-offset-background",r),...s,children:[u,j&&e.jsx("div",{className:"pointer-events-none absolute inset-0 flex items-center justify-center",children:e.jsx("div",{className:"animate-caret-blink h-4 w-px bg-foreground duration-1000"})})]})});H.displayName="InputOTPSlot";const ht=t.forwardRef(({...n},r)=>e.jsx("div",{ref:r,role:"separator",...n,children:e.jsx(et,{})}));ht.displayName="InputOTPSeparator";function Et(){const{user:n}=ze(),r=Ge(),[s,i]=t.useState("idle"),[v,u]=t.useState(""),[j,w]=t.useState(!1),[N]=t.useState("JBSWY3DPEHPK3PXP"),[L]=t.useState(["abc123","def456","ghi789","jkl012","mno345"]),{data:f,isLoading:R}=Ye({queryKey:["totp",n==null?void 0:n.id],enabled:!!(n!=null&&n.id),queryFn:async()=>({is_enabled:!1,backup_codes:[]})}),x=Se({mutationFn:async()=>{},onSuccess:()=>{r.invalidateQueries({queryKey:["totp"]}),i("idle"),z({title:"2FA Enabled",description:"Your account is now protected."})}}),E=Se({mutationFn:async()=>{},onSuccess:()=>{r.invalidateQueries({queryKey:["totp"]}),z({title:"2FA Disabled"})}}),m=!!(f!=null&&f.is_enabled),C=()=>{if(v.length!==6){z({title:"Invalid code",description:"Enter a 6-digit code",variant:"destructive"});return}x.mutate()},A=`otpauth://totp/UpgradedProxy:${n==null?void 0:n.email}?secret=${N}&issuer=UpgradedProxy`;return e.jsxs(e.Fragment,{children:[e.jsx(Ue,{title:"Security & 2FA",noindex:!0}),e.jsxs("div",{className:"space-y-6",children:[e.jsx("h1",{className:"text-2xl font-bold",children:"Security & 2FA"}),e.jsxs(X,{children:[e.jsx(ie,{children:e.jsxs("div",{className:"flex items-center gap-3",children:[m?e.jsx(Je,{className:"h-8 w-8 text-success"}):e.jsx(Qe,{className:"h-8 w-8 text-muted-foreground"}),e.jsxs("div",{children:[e.jsx(oe,{className:"text-lg",children:"Two-Factor Authentication (TOTP)"}),e.jsx(Ke,{children:"Add an extra layer of security using an authenticator app like Google Authenticator or Authy."})]}),e.jsx(we,{variant:m?"default":"secondary",className:"ml-auto",children:m?"Enabled":"Disabled"})]})}),e.jsxs(Z,{className:"space-y-4",children:[m&&s==="idle"&&e.jsxs(e.Fragment,{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"✅ Two-factor authentication is active on your account."}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(T,{variant:"outline",size:"sm",onClick:()=>w(!j),children:[j?e.jsx(Xe,{className:"mr-1 h-4 w-4"}):e.jsx(Ze,{className:"mr-1 h-4 w-4"}),j?"Hide":"Show"," Backup Codes"]}),e.jsx(T,{variant:"destructive",size:"sm",onClick:()=>E.mutate(),children:"Disable 2FA"})]}),j&&(f==null?void 0:f.backup_codes)&&e.jsx(X,{className:"bg-muted",children:e.jsxs(Z,{className:"py-3",children:[e.jsx("p",{className:"text-xs font-medium mb-2",children:"Save these backup codes in a safe place:"}),e.jsx("div",{className:"grid grid-cols-2 gap-1",children:f.backup_codes.map((o,B)=>e.jsx("code",{className:"text-xs font-mono bg-background px-2 py-1 rounded",children:o},B))}),e.jsxs(T,{variant:"ghost",size:"sm",className:"mt-2",onClick:()=>{navigator.clipboard.writeText(f.backup_codes.join(`
`)),z({title:"Copied"})},children:[e.jsx(Ne,{className:"mr-1 h-3 w-3"})," Copy All"]})]})})]}),!m&&s==="idle"&&e.jsxs(T,{onClick:()=>i("setup"),children:[e.jsx(Ve,{className:"mr-2 h-4 w-4"})," Enable 2FA"]}),s==="setup"&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("p",{className:"text-sm font-medium",children:"1. Scan this QR code with your authenticator app:"}),e.jsx("div",{className:"flex items-center justify-center rounded-lg border bg-white p-6",style:{maxWidth:240},children:e.jsx("img",{src:`https://api.qrserver.com/v1/create-qr-code/?size=200x200&data=${encodeURIComponent(A)}`,alt:"2FA QR Code",className:"w-48 h-48"})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("p",{className:"text-sm font-medium",children:"Or enter this secret manually:"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("code",{className:"bg-muted px-3 py-1.5 rounded text-sm font-mono",children:N}),e.jsx(T,{variant:"ghost",size:"icon",onClick:()=>{navigator.clipboard.writeText(N),z({title:"Copied"})},children:e.jsx(Ne,{className:"h-4 w-4"})})]})]}),e.jsx(T,{onClick:()=>i("verify"),children:"Next: Verify Code"})]}),s==="verify"&&e.jsxs("div",{className:"space-y-4",children:[e.jsx("p",{className:"text-sm font-medium",children:"2. Enter the 6-digit code from your authenticator app:"}),e.jsx(Oe,{maxLength:6,value:v,onChange:u,children:e.jsxs(Re,{children:[e.jsx(H,{index:0}),e.jsx(H,{index:1}),e.jsx(H,{index:2}),e.jsx(H,{index:3}),e.jsx(H,{index:4}),e.jsx(H,{index:5})]})}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(T,{variant:"outline",onClick:()=>{i("setup"),u("")},children:"Back"}),e.jsx(T,{onClick:C,disabled:v.length!==6,children:"Verify & Enable"})]})]})]})]}),e.jsxs(X,{children:[e.jsx(ie,{children:e.jsx(oe,{className:"text-lg",children:"Change Password"})}),e.jsxs(Z,{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2 max-w-sm",children:[e.jsx(Ce,{children:"New Password"}),e.jsx(ye,{type:"password",placeholder:"••••••••"})]}),e.jsxs("div",{className:"space-y-2 max-w-sm",children:[e.jsx(Ce,{children:"Confirm New Password"}),e.jsx(ye,{type:"password",placeholder:"••••••••"})]}),e.jsx(T,{onClick:()=>z({title:"Password updated"}),children:"Update Password"})]})]}),e.jsxs(X,{children:[e.jsx(ie,{children:e.jsx(oe,{className:"text-lg",children:"Active Sessions"})}),e.jsx(Z,{children:e.jsxs("div",{className:"flex items-center justify-between rounded-lg border p-3",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium",children:"Current Session"}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:["Browser • ",navigator.userAgent.split(" ").pop()]})]}),e.jsx(we,{variant:"default",children:"Active"})]})})]})]})]})}export{Et as default};
