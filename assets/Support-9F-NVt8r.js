import{j as e,y as T,J as w,x as o,z as k,A as D,E as L,H as O,K as P}from"./ui-DC8iaVTx.js";import{r as n,aC as E,Y as H,a4 as g,an as I,a3 as R}from"./vendor-4c0ygcws.js";import{S as _}from"./SEOHead-BORGa4Gz.js";import{C as A,c as B}from"./card-Dh3ArVV7.js";import{L as M,I as Y,e as F,f as V,g as q,h as z,i as d,B as y,t as S}from"./index-3EyxI0PB.js";import{L as x}from"./label-BsBlhyYN.js";import{T as G}from"./textarea-CQC14rsn.js";import{T as J,a as K,b as f,c as a,d as U,e as t}from"./table-CkxPTGa1.js";import{E as Q}from"./EmptyState-C4pg9dCt.js";import{i as W}from"./use-backend-w5pdMG_9.js";import"./useMutation-CJz9VLMx.js";const X={open:{color:"secondary",icon:R},in_progress:{color:"default",icon:I},resolved:{color:"outline",icon:g},closed:{color:"outline",icon:g}},Z={low:"secondary",normal:"default",high:"destructive"};function de(){const{data:r,isLoading:C,createTicket:c}=W(),[i,h]=n.useState(""),[u,b]=n.useState("normal"),[l,m]=n.useState(""),[v,j]=n.useState(!1),N=async()=>{if(!(!i.trim()||!l.trim()))try{await c.mutateAsync({subject:i,message:l,priority:u}),h(""),m(""),j(!1),S({title:"Ticket Created",description:"Your support ticket has been submitted."})}catch(s){S({title:"Error",description:s.message,variant:"destructive"})}};return C?e.jsx(M,{}):e.jsxs(e.Fragment,{children:[e.jsx(_,{title:"Support",noindex:!0}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h1",{className:"text-2xl font-bold",children:"Support Tickets"}),e.jsxs(T,{open:v,onOpenChange:j,children:[e.jsx(w,{asChild:!0,children:e.jsxs(o,{children:[e.jsx(E,{className:"mr-1 h-4 w-4"})," New Ticket"]})}),e.jsxs(k,{children:[e.jsx(D,{children:e.jsx(L,{children:"Create Support Ticket"})}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-1.5",children:[e.jsx(x,{children:"Subject"}),e.jsx(Y,{value:i,onChange:s=>h(s.target.value),placeholder:"Brief description of your issue"})]}),e.jsxs("div",{className:"space-y-1.5",children:[e.jsx(x,{children:"Priority"}),e.jsxs(F,{value:u,onValueChange:b,children:[e.jsx(V,{children:e.jsx(q,{})}),e.jsxs(z,{children:[e.jsx(d,{value:"low",children:"Low"}),e.jsx(d,{value:"normal",children:"Normal"}),e.jsx(d,{value:"high",children:"High"})]})]})]}),e.jsxs("div",{className:"space-y-1.5",children:[e.jsx(x,{children:"Message"}),e.jsx(G,{value:l,onChange:s=>m(s.target.value),placeholder:"Describe your issue in detail...",rows:4})]})]}),e.jsxs(O,{children:[e.jsx(P,{asChild:!0,children:e.jsx(o,{variant:"outline",children:"Cancel"})}),e.jsx(o,{onClick:N,disabled:!i.trim()||!l.trim()||c.isPending,children:c.isPending?"Submitting…":"Submit Ticket"})]})]})]})]}),r!=null&&r.length?e.jsx(A,{children:e.jsx(B,{className:"p-0",children:e.jsxs(J,{children:[e.jsx(K,{children:e.jsxs(f,{children:[e.jsx(a,{children:"Subject"}),e.jsx(a,{children:"Priority"}),e.jsx(a,{children:"Status"}),e.jsx(a,{children:"Admin Reply"}),e.jsx(a,{className:"text-right",children:"Created"})]})}),e.jsx(U,{children:r.map(s=>{var p;return e.jsxs(f,{children:[e.jsx(t,{className:"font-medium",children:s.subject}),e.jsx(t,{children:e.jsx(y,{variant:Z[s.priority]??"secondary",className:"text-xs",children:s.priority})}),e.jsx(t,{children:e.jsx(y,{variant:((p=X[s.status])==null?void 0:p.color)??"secondary",className:"text-xs",children:s.status.replace("_"," ")})}),e.jsx(t,{className:"max-w-[200px] truncate text-sm text-muted-foreground",children:s.admin_reply??"—"}),e.jsx(t,{className:"text-right text-xs text-muted-foreground",children:new Date(s.created_at).toLocaleDateString()})]},s.id)})})]})})}):e.jsx(Q,{icon:H,title:"No tickets",description:"You haven't created any support tickets yet."})]})]})}export{de as default};
