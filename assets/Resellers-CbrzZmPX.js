import{U as A,r as b,j as e,a as f,I as o,t as C,ae as _,V as S,o as N,s as l,aQ as P,aj as j,ah as B}from"./index-CcDiZfit.js";import{u as T}from"./useMutation-DlIq6RiF.js";import{C as m,a as x,b as u,c as h}from"./card-DN0qsfCY.js";import{L as d}from"./label-DK_BhmV_.js";import{B as E}from"./badge-CzJPljEI.js";import{T as k,a as q,b as R,c,d as I,e as t}from"./table-Br2AV7tZ.js";import{D as L,a as Q,b as H,c as U,d as K}from"./dialog-CyUA1K9m.js";import{S as O}from"./switch-SOEU9Ewh.js";import{P as M}from"./plus-DnD0gHS2.js";const g=N({id:j().or(l()),user_id:j().or(l()),company_name:l(),commission_rate:j().or(l()),brand_primary_color:l().nullable(),brand_secondary_color:l().nullable(),custom_domain:l().nullable(),is_active:P().or(j()),user:N({email:l()}).optional()});function W(){return S({queryKey:["admin-resellers"],queryFn:()=>_.get("/admin/resellers",B(g))})}function se(){const{data:r,isLoading:D}=W(),y=A(),[F,v]=b.useState(!1),[n,i]=b.useState({user_id:"",company_name:"",commission_rate:"10",brand_primary_color:"#3B82F6",brand_secondary_color:"#1E40AF",custom_domain:""}),p=T({mutationFn:()=>_.post("/admin/resellers",g,{user_id:n.user_id,company_name:n.company_name,commission_rate:parseFloat(n.commission_rate),brand_primary_color:n.brand_primary_color,brand_secondary_color:n.brand_secondary_color,custom_domain:n.custom_domain||null}),onSuccess:()=>{y.invalidateQueries({queryKey:["admin-resellers"]}),C({title:"Reseller created successfully"}),v(!1)},onError:s=>C({title:"Error",description:s.message,variant:"destructive"})}),w=T({mutationFn:({id:s,is_active:a})=>_.put(`/admin/resellers/${s}`,g,{is_active:a}),onSuccess:()=>y.invalidateQueries({queryKey:["admin-resellers"]})});return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold",children:"White-Label Reseller Portal"}),e.jsx("p",{className:"text-muted-foreground",children:"Manage reseller partners and their branding"})]}),e.jsxs(L,{open:F,onOpenChange:v,children:[e.jsx(Q,{asChild:!0,children:e.jsxs(f,{children:[e.jsx(M,{className:"mr-2 h-4 w-4"}),"Add Reseller"]})}),e.jsxs(H,{children:[e.jsx(U,{children:e.jsx(K,{children:"Create Reseller Profile"})}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(d,{children:"User ID"}),e.jsx(o,{placeholder:"UUID of existing user",value:n.user_id,onChange:s=>i(a=>({...a,user_id:s.target.value}))})]}),e.jsxs("div",{children:[e.jsx(d,{children:"Company Name"}),e.jsx(o,{value:n.company_name,onChange:s=>i(a=>({...a,company_name:s.target.value}))})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(d,{children:"Commission Rate (%)"}),e.jsx(o,{type:"number",value:n.commission_rate,onChange:s=>i(a=>({...a,commission_rate:s.target.value}))})]}),e.jsxs("div",{children:[e.jsx(d,{children:"Custom Domain"}),e.jsx(o,{placeholder:"reseller.example.com",value:n.custom_domain,onChange:s=>i(a=>({...a,custom_domain:s.target.value}))})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(d,{children:"Primary Color"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{type:"color",value:n.brand_primary_color,onChange:s=>i(a=>({...a,brand_primary_color:s.target.value})),className:"h-9 w-12 rounded border cursor-pointer"}),e.jsx(o,{value:n.brand_primary_color,onChange:s=>i(a=>({...a,brand_primary_color:s.target.value}))})]})]}),e.jsxs("div",{children:[e.jsx(d,{children:"Secondary Color"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{type:"color",value:n.brand_secondary_color,onChange:s=>i(a=>({...a,brand_secondary_color:s.target.value})),className:"h-9 w-12 rounded border cursor-pointer"}),e.jsx(o,{value:n.brand_secondary_color,onChange:s=>i(a=>({...a,brand_secondary_color:s.target.value}))})]})]})]}),e.jsx(f,{onClick:()=>p.mutate(),disabled:p.isPending,className:"w-full",children:p.isPending?"Creating…":"Create Reseller"})]})]})]})]}),e.jsxs("div",{className:"grid gap-4 md:grid-cols-4",children:[e.jsxs(m,{children:[e.jsx(x,{className:"pb-2",children:e.jsx(u,{className:"text-sm font-medium text-muted-foreground",children:"Total Resellers"})}),e.jsx(h,{children:e.jsx("div",{className:"text-2xl font-bold",children:(r==null?void 0:r.length)??0})})]}),e.jsxs(m,{children:[e.jsx(x,{className:"pb-2",children:e.jsx(u,{className:"text-sm font-medium text-muted-foreground",children:"Active"})}),e.jsx(h,{children:e.jsx("div",{className:"text-2xl font-bold text-success",children:(r==null?void 0:r.filter(s=>s.is_active).length)??0})})]}),e.jsxs(m,{children:[e.jsx(x,{className:"pb-2",children:e.jsx(u,{className:"text-sm font-medium text-muted-foreground",children:"With Custom Domain"})}),e.jsx(h,{children:e.jsx("div",{className:"text-2xl font-bold",children:(r==null?void 0:r.filter(s=>s.custom_domain).length)??0})})]}),e.jsxs(m,{children:[e.jsx(x,{className:"pb-2",children:e.jsx(u,{className:"text-sm font-medium text-muted-foreground",children:"Avg Commission"})}),e.jsx(h,{children:e.jsxs("div",{className:"text-2xl font-bold",children:[r!=null&&r.length?(r.reduce((s,a)=>s+Number(a.commission_rate),0)/r.length).toFixed(1):0,"%"]})})]})]}),e.jsxs(m,{children:[e.jsx(x,{children:e.jsx(u,{children:"Reseller Partners"})}),e.jsx(h,{children:D?e.jsx("p",{className:"text-muted-foreground",children:"Loading…"}):e.jsxs(k,{children:[e.jsx(q,{children:e.jsxs(R,{children:[e.jsx(c,{children:"Company"}),e.jsx(c,{children:"Domain"}),e.jsx(c,{children:"Commission"}),e.jsx(c,{children:"Branding"}),e.jsx(c,{children:"Status"}),e.jsx(c,{children:"Active"})]})}),e.jsx(I,{children:r==null?void 0:r.map(s=>e.jsxs(R,{children:[e.jsx(t,{className:"font-medium",children:s.company_name}),e.jsx(t,{children:s.custom_domain||e.jsx("span",{className:"text-muted-foreground",children:"—"})}),e.jsxs(t,{children:[Number(s.commission_rate),"%"]}),e.jsx(t,{children:e.jsxs("div",{className:"flex gap-1",children:[e.jsx("div",{className:"h-5 w-5 rounded",style:{backgroundColor:s.brand_primary_color??"#3B82F6"}}),e.jsx("div",{className:"h-5 w-5 rounded",style:{backgroundColor:s.brand_secondary_color??"#1E40AF"}})]})}),e.jsx(t,{children:e.jsx(E,{variant:s.is_active?"default":"secondary",children:s.is_active?"Active":"Inactive"})}),e.jsx(t,{children:e.jsx(O,{checked:s.is_active??!1,onCheckedChange:a=>w.mutate({id:s.id,is_active:a})})})]},s.id))})]})})]})]})}export{se as default};
