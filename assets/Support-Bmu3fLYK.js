import{r as o,j as e,P as T,B as n,I as w,q as k,v as D,w as P,x as O,y as d,p as L,t as g}from"./index-BS3MrMDR.js";import{S as _}from"./SEOHead-CxpTJHm8.js";import{C as B,c as E}from"./card-DayAM_BL.js";import{L as x}from"./label-WpXwRrp2.js";import{T as I}from"./textarea-vWVragg4.js";import{B as f}from"./badge-TlMpNj1c.js";import{D as R,a as H,b as A,c as M,d as F,e as Y,g as q}from"./dialog-Du_uRE6n.js";import{T as V,a as G,b as y,c as t,d as U,e as a}from"./table-BLekKfgE.js";import{E as z}from"./EmptyState-XNfTWzjJ.js";import{l as J}from"./use-backend-cpHbbH4Y.js";import{P as K}from"./plus-DJNvFprH.js";import{C}from"./circle-check-Ck0Y18qS.js";import{C as Q}from"./clock-3VCS3lev.js";import{C as W}from"./circle-alert-DyyHSvkQ.js";import"./useQuery-D_JWgd3B.js";import"./useMutation-BUadc-Ou.js";import"./api-BTF2QDx4.js";const X={open:{color:"secondary",icon:W},in_progress:{color:"default",icon:Q},resolved:{color:"outline",icon:C},closed:{color:"outline",icon:C}},Z={low:"secondary",normal:"default",high:"destructive"};function je(){const{data:r,isLoading:S,createTicket:c}=J(),[i,m]=o.useState(""),[h,b]=o.useState("normal"),[l,u]=o.useState(""),[v,p]=o.useState(!1),N=async()=>{if(!(!i.trim()||!l.trim()))try{await c.mutateAsync({subject:i,message:l,priority:h}),m(""),u(""),p(!1),g({title:"Ticket Created",description:"Your support ticket has been submitted."})}catch(s){g({title:"Error",description:s.message,variant:"destructive"})}};return S?e.jsx(T,{}):e.jsxs(e.Fragment,{children:[e.jsx(_,{title:"Support",noindex:!0}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h1",{className:"text-2xl font-bold",children:"Support Tickets"}),e.jsxs(R,{open:v,onOpenChange:p,children:[e.jsx(H,{asChild:!0,children:e.jsxs(n,{children:[e.jsx(K,{className:"mr-1 h-4 w-4"})," New Ticket"]})}),e.jsxs(A,{children:[e.jsx(M,{children:e.jsx(F,{children:"Create Support Ticket"})}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-1.5",children:[e.jsx(x,{children:"Subject"}),e.jsx(w,{value:i,onChange:s=>m(s.target.value),placeholder:"Brief description of your issue"})]}),e.jsxs("div",{className:"space-y-1.5",children:[e.jsx(x,{children:"Priority"}),e.jsxs(k,{value:h,onValueChange:b,children:[e.jsx(D,{children:e.jsx(P,{})}),e.jsxs(O,{children:[e.jsx(d,{value:"low",children:"Low"}),e.jsx(d,{value:"normal",children:"Normal"}),e.jsx(d,{value:"high",children:"High"})]})]})]}),e.jsxs("div",{className:"space-y-1.5",children:[e.jsx(x,{children:"Message"}),e.jsx(I,{value:l,onChange:s=>u(s.target.value),placeholder:"Describe your issue in detail...",rows:4})]})]}),e.jsxs(Y,{children:[e.jsx(q,{asChild:!0,children:e.jsx(n,{variant:"outline",children:"Cancel"})}),e.jsx(n,{onClick:N,disabled:!i.trim()||!l.trim()||c.isPending,children:c.isPending?"Submitting…":"Submit Ticket"})]})]})]})]}),r!=null&&r.length?e.jsx(B,{children:e.jsx(E,{className:"p-0",children:e.jsxs(V,{children:[e.jsx(G,{children:e.jsxs(y,{children:[e.jsx(t,{children:"Subject"}),e.jsx(t,{children:"Priority"}),e.jsx(t,{children:"Status"}),e.jsx(t,{children:"Admin Reply"}),e.jsx(t,{className:"text-right",children:"Created"})]})}),e.jsx(U,{children:r.map(s=>{var j;return e.jsxs(y,{children:[e.jsx(a,{className:"font-medium",children:s.subject}),e.jsx(a,{children:e.jsx(f,{variant:Z[s.priority]??"secondary",className:"text-xs",children:s.priority})}),e.jsx(a,{children:e.jsx(f,{variant:((j=X[s.status])==null?void 0:j.color)??"secondary",className:"text-xs",children:s.status.replace("_"," ")})}),e.jsx(a,{className:"max-w-[200px] truncate text-sm text-muted-foreground",children:s.admin_reply??"—"}),e.jsx(a,{className:"text-right text-xs text-muted-foreground",children:s.created_at?new Date(s.created_at).toLocaleDateString():"—"})]},s.id)})})]})})}):e.jsx(z,{icon:L,title:"No tickets",description:"You haven't created any support tickets yet."})]})]})}export{je as default};
