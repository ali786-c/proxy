import{Z as g,r as y,_ as C,j as e,S as N,a as S,I as v,k as b,E as T,J as w,K as E,N as R,O as h,t as u,aj as j,al as q,q as A,s as n,aO as L,ao as U}from"./index-Cl2slAZZ.js";import{S as H}from"./SEOHead-DgXLMDjT.js";import{C as I,a as K,b as M,c as Q}from"./card-B8OYlSOh.js";import{T as B,a as F,b as t,c as l,d as O,e as r}from"./table-CqP-QKlx.js";import{u as P}from"./useMutation-C3uQ2xJQ.js";import{R as k}from"./refresh-cw-CwXxYdNQ.js";import{S as z}from"./search-D3sKpFE9.js";const V=A({id:L(),name:n().nullable(),email:n(),role:n()});function X(){const c=g(),[i,p]=y.useState(""),{data:f=[],isLoading:d}=C({queryKey:["admin-users-roles"],queryFn:()=>j.get("/admin/users",U(V))}),o=P({mutationFn:({userId:s,role:a})=>j.post(`/admin/users/${s}/role`,q,{role:a}),onSuccess:()=>{c.invalidateQueries({queryKey:["admin-users-roles"]}),u({title:"Role Updated",description:"User permissions have been modified."})},onError:s=>u({title:"Error",description:s.message,variant:"destructive"})}),m=f.filter(s=>{var a,x;return((a=s.name)==null?void 0:a.toLowerCase().includes(i.toLowerCase()))||((x=s.email)==null?void 0:x.toLowerCase().includes(i.toLowerCase()))});return e.jsxs(e.Fragment,{children:[e.jsx(H,{title:"Admin â€” User Permissions",noindex:!0}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs("h1",{className:"text-2xl font-bold flex items-center gap-2",children:[e.jsx(N,{className:"h-6 w-6"})," User Roles"]}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Manage administrative access for system users."})]}),e.jsx(S,{variant:"ghost",size:"icon",onClick:()=>c.invalidateQueries({queryKey:["admin-users-roles"]}),children:e.jsx(k,{className:"h-4 w-4"})})]}),e.jsxs("div",{className:"relative max-w-sm",children:[e.jsx(z,{className:"absolute left-3 top-1/2 h-4 w-4 -translate-y-1/2 text-muted-foreground"}),e.jsx(v,{placeholder:"Search by name or email...",value:i,onChange:s=>p(s.target.value),className:"pl-9"})]}),e.jsxs(I,{children:[e.jsx(K,{children:e.jsx(M,{children:"Access Control"})}),e.jsx(Q,{className:"p-0",children:e.jsxs(B,{children:[e.jsx(F,{children:e.jsxs(t,{children:[e.jsx(l,{children:"User"}),e.jsx(l,{children:"Email"}),e.jsx(l,{children:"Current Role"}),e.jsx(l,{className:"text-right",children:"Actions"})]})}),e.jsxs(O,{children:[d?e.jsx(t,{children:e.jsx(r,{colSpan:4,className:"h-24 text-center",children:"Loading users..."})}):m.map(s=>e.jsxs(t,{children:[e.jsx(r,{className:"font-medium",children:s.name||"N/A"}),e.jsx(r,{className:"text-sm",children:s.email}),e.jsx(r,{children:e.jsx(b,{variant:s.role==="admin"?"default":"secondary",className:"capitalize",children:s.role})}),e.jsx(r,{className:"text-right",children:e.jsxs(T,{value:s.role,onValueChange:a=>o.mutate({userId:s.id,role:a}),disabled:o.isPending,children:[e.jsx(w,{className:"w-[120px] ml-auto h-8 text-xs",children:e.jsx(E,{})}),e.jsxs(R,{children:[e.jsx(h,{value:"client",children:"Client"}),e.jsx(h,{value:"admin",children:"Admin"})]})]})})]},s.id)),!d&&m.length===0&&e.jsx(t,{children:e.jsx(r,{colSpan:4,className:"h-24 text-center text-muted-foreground",children:"No users found."})})]})]})})]})]})]})}export{X as default};
