import{j as e,x as l,y as ee,z as se,A as ae,E as te,G as le,H as ie}from"./ui-CeaNA1b8.js";import{r as a,aC as ne,F as re,an as ce,aW as He,ar as Me,aX as de,V as Oe,ae as oe,aY as Ve,aw as g,G as We,aD as xe,al as Re,aF as L,aa as Ye,aZ as qe}from"./vendor-CSZBJNtL.js";import{S as Ze}from"./SEOHead-Dfo6dpCS.js";import{C as d,c as o}from"./card-clxFFivi.js";import{I as x,e as he,f as me,g as ue,h as ge,i as j,B as je,t as p}from"./index-Dr9N_a8S.js";import{T as Qe,a as Xe,b as G,c as pe}from"./tabs-Cy4EU806.js";import{L as n}from"./label-5YbheAOU.js";import{T as Ne}from"./textarea-Bgz8icSC.js";import{T as fe,a as ve,b as N,c as r,d as ye,e as i}from"./table-D3uMK-0w.js";import{S as Je}from"./switch-ByevN5Ru.js";import{p as $e,q as es,r as ss,s as as,t as ts,v as ls,w as is,x as ns,y as rs,z as cs}from"./use-backend-WLUrADBk.js";import"./useMutation-8NIbHAl5.js";const ds={draft:"outline",published:"default"};function Cs(){var Y,q,Z,Q,X,J;const[we,be]=a.useState("posts"),[k,Ce]=a.useState("all"),[D,Se]=a.useState(""),[Pe,f]=a.useState(!1),[Ae,v]=a.useState(!1),[Te,F]=a.useState(null),[h,y]=a.useState(""),[m,w]=a.useState(""),[b,C]=a.useState(""),{data:_e=[],isLoading:ke}=$e(),B=es(),I=ss(),De=as(),S=ts(),{data:t={keywords:[],settings:{}},isLoading:os}=ls(),P=is(),E=ns(),z=rs(),u=cs(),[A,K]=a.useState(""),[Be,xs]=a.useState("General"),[U,H]=a.useState(""),[M,O]=a.useState(""),[Ie,V]=a.useState(0),W=["Selecting the best keyword...","Contacting Gemini 2.5 Flash...","Writing high-quality content...","Formatting HTML & SEO optimizations...","Saving to database..."];a.useEffect(()=>{let s;return u.isPending?(V(0),s=setInterval(()=>{V(c=>(c+1)%W.length)},3e3)):clearInterval(s),()=>clearInterval(s)},[u.isPending]),a.useEffect(()=>{t.settings&&(H(t.settings.gemini_api_key||""),O(t.settings.gemini_model||"gemini-2.5-flash"))},[t.settings]);const T=_e.map(s=>({...s,status:s.is_draft?"draft":"published"})),Le=()=>{B.mutate({title:h,content:m,image_url:b},{onSuccess:()=>{f(!1),_(),p({title:"Draft created",description:"Your article has been saved as a draft."})}})},Ge=()=>{I.mutate({id:Te.id,data:{title:h,content:m,image_url:b}},{onSuccess:()=>{v(!1),_(),p({title:"Post updated"})}})},Fe=s=>{confirm("Are you sure you want to delete this post?")&&De.mutate(s,{onSuccess:()=>p({title:"Post deleted"})})},Ee=(s,c)=>{S.mutate({id:s,is_draft:!c},{onSuccess:()=>p({title:c?"Article Published":"Moved to Drafts",description:c?"The article is now live on the blog.":"The article has been hidden."})})},ze=s=>{F(s),y(s.title),w(s.content),C(s.image_url||""),v(!0)},_=()=>{y(""),w(""),C(""),F(null)},R=T.filter(s=>!(k!=="all"&&s.status!==k||D&&!s.title.toLowerCase().includes(D.toLowerCase()))),Ke=T.filter(s=>s.status==="draft").length,Ue=T.filter(s=>s.status==="published").length;return e.jsxs(e.Fragment,{children:[e.jsx(Ze,{title:"Admin — Blog Management",noindex:!0}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold",children:"Blog Management"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Manage articles, news, and updates for your users."})]}),e.jsxs(l,{onClick:()=>f(!0),className:"gap-2",children:[e.jsx(ne,{className:"h-4 w-4"})," New Article"]})]}),e.jsxs("div",{className:"grid gap-4 sm:grid-cols-4",children:[e.jsx(d,{children:e.jsx(o,{className:"pt-6",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"rounded-lg bg-primary/10 p-2.5",children:e.jsx(re,{className:"h-5 w-5 text-primary"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-2xl font-bold",children:T.length}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Total Posts"})]})]})})}),e.jsx(d,{children:e.jsx(o,{className:"pt-6",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"rounded-lg bg-primary/10 p-2.5",children:e.jsx(ce,{className:"h-5 w-5 text-primary"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-2xl font-bold",children:Ke}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Drafts"})]})]})})}),e.jsx(d,{children:e.jsx(o,{className:"pt-6",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"rounded-lg bg-primary/10 p-2.5",children:e.jsx(He,{className:"h-5 w-5 text-primary"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-2xl font-bold",children:Ue}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Published"})]})]})})}),e.jsx(d,{children:e.jsx(o,{className:"pt-6",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"rounded-lg bg-primary/10 p-2.5",children:e.jsx(Me,{className:"h-5 w-5 text-primary"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-2xl font-bold",children:"—"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Total Views"})]})]})})})]}),e.jsxs(Qe,{value:we,onValueChange:be,children:[e.jsxs(Xe,{children:[e.jsxs(G,{value:"posts",className:"gap-1.5",children:[e.jsx(re,{className:"h-3.5 w-3.5"})," Articles"]}),e.jsxs(G,{value:"automation",className:"gap-1.5",children:[e.jsx(de,{className:"h-3.5 w-3.5"})," Automation"]}),e.jsxs(G,{value:"channels",className:"gap-1.5 disabled",disabled:!0,children:[e.jsx(Oe,{className:"h-3.5 w-3.5"})," Channels (Coming Soon)"]})]}),e.jsxs(pe,{value:"posts",className:"mt-4 space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("div",{className:"relative flex-1",children:[e.jsx(oe,{className:"absolute left-3 top-1/2 h-4 w-4 -translate-y-1/2 text-muted-foreground"}),e.jsx(x,{placeholder:"Search posts…",value:D,onChange:s=>Se(s.target.value),className:"pl-9"})]}),e.jsxs(he,{value:k,onValueChange:Ce,children:[e.jsx(me,{className:"w-32",children:e.jsx(ue,{})}),e.jsxs(ge,{children:[e.jsx(j,{value:"all",children:"All"}),e.jsx(j,{value:"draft",children:"Drafts"}),e.jsx(j,{value:"published",children:"Published"})]})]})]}),e.jsx(d,{children:e.jsx(o,{className:"p-0",children:e.jsxs(fe,{children:[e.jsx(ve,{children:e.jsxs(N,{children:[e.jsx(r,{children:"Title"}),e.jsx(r,{children:"Author"}),e.jsx(r,{children:"Status"}),e.jsx(r,{children:"Date"}),e.jsx(r,{className:"text-right",children:"Actions"})]})}),e.jsxs(ye,{children:[R.map(s=>{var c,$;return e.jsxs(N,{className:"group",children:[e.jsx(i,{children:e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-sm",children:s.title}),e.jsx("p",{className:"text-xs text-muted-foreground truncate max-w-[300px]",children:s.slug})]})}),e.jsx(i,{children:e.jsx("span",{className:"text-sm font-medium",children:((c=s.author)==null?void 0:c.name)||"System"})}),e.jsx(i,{children:e.jsx(je,{variant:ds[s.status]??"outline",className:"text-[10px] uppercase",children:s.status})}),e.jsx(i,{className:"text-sm text-muted-foreground",children:new Date(s.published_at||s.created_at).toLocaleDateString()}),e.jsx(i,{children:e.jsxs("div",{className:"flex justify-end gap-1",children:[e.jsx(l,{size:"icon",variant:"ghost",onClick:()=>ze(s),className:"h-8 w-8",children:e.jsx(Ve,{className:"h-3.5 w-3.5"})}),e.jsx(l,{size:"sm",variant:s.is_draft?"default":"outline",onClick:()=>Ee(s.id,s.is_draft),disabled:S.isPending,className:"h-8 gap-1",children:S.isPending&&(($=S.variables)==null?void 0:$.id)===s.id?e.jsx(g,{className:"h-3 w-3 animate-spin"}):s.is_draft?e.jsxs(e.Fragment,{children:[e.jsx(We,{className:"h-3 w-3"})," Publish"]}):e.jsxs(e.Fragment,{children:[e.jsx(ce,{className:"h-3 w-3"})," Unpublish"]})}),e.jsx(l,{size:"icon",variant:"ghost",onClick:()=>Fe(s.id),className:"h-8 w-8 text-destructive hover:text-destructive",children:e.jsx(xe,{className:"h-3.5 w-3.5"})})]})})]},s.id)}),R.length===0&&e.jsx(N,{children:e.jsx(i,{colSpan:5,className:"h-32 text-center text-muted-foreground",children:ke?e.jsx(g,{className:"h-6 w-6 animate-spin mx-auto"}):"No posts found."})})]})]})})})]}),e.jsxs(pe,{value:"automation",className:"mt-4 space-y-6",children:[e.jsxs("div",{className:"grid gap-6 md:grid-cols-2",children:[e.jsx(d,{children:e.jsxs(o,{className:"pt-6 space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-2 font-semibold text-lg",children:[e.jsx(Re,{className:"h-5 w-5 text-primary"}),"Gemini AI Configuration"]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"space-y-1.5",children:[e.jsx(n,{children:"Google Gemini API Key"}),e.jsx("div",{className:"flex gap-2",children:e.jsx(x,{type:"password",name:"gemini_api_key_field",autoComplete:"new-password",placeholder:"AIza...",value:U,onChange:s=>H(s.target.value)})}),e.jsx("p",{className:"text-[10px] text-muted-foreground",children:"Get your key from Google AI Studio"})]}),e.jsxs("div",{className:"space-y-1.5",children:[e.jsx(n,{children:"Model Selection"}),e.jsxs(he,{value:M,onValueChange:O,children:[e.jsx(me,{children:e.jsx(ue,{})}),e.jsxs(ge,{children:[e.jsx(j,{value:"gemini-2.5-flash",children:"Gemini 2.5 Flash (Fash & Verified)"}),e.jsx(j,{value:"gemini-1.5-flash",children:"Gemini 1.5 Flash (Fash & Cheap)"}),e.jsx(j,{value:"gemini-1.5-pro",children:"Gemini 1.5 Pro (High Quality)"})]})]})]}),e.jsx("div",{className:"pt-2",children:e.jsxs(l,{size:"sm",className:"w-full gap-2",onClick:()=>P.mutate({gemini_api_key:U,gemini_model:M},{onSuccess:()=>p({title:"Settings Saved",description:"Gemini configuration updated successfully."})}),disabled:P.isPending,children:[P.isPending?e.jsx(g,{className:"h-4 w-4 animate-spin"}):e.jsx(L,{className:"h-4 w-4"}),"Save Settings"]})}),e.jsxs("div",{className:"flex items-center justify-between pt-2",children:[e.jsxs("div",{className:"space-y-0.5",children:[e.jsx(n,{children:"Daily Auto-Posting"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Automatically post 1 article every day"})]}),e.jsx(Je,{checked:(Y=t.settings)==null?void 0:Y.auto_posting_enabled,onCheckedChange:s=>P.mutate({auto_blog_enabled:s})})]})]})]})}),e.jsx(d,{children:e.jsxs(o,{className:"pt-6 space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-2 font-semibold text-lg",children:[e.jsx(Ye,{className:"h-5 w-5 text-yellow-500"}),"Instant Content Generation"]}),e.jsx("p",{className:"text-sm text-muted-foreground italic",children:"Push the button below to immediately generate and publish a professional blog post using your next available keyword."}),e.jsxs(l,{className:"w-full h-12 gap-2 text-md font-bold transition-all",variant:"secondary",disabled:u.isPending||!((q=t.settings)!=null&&q.gemini_api_key)||!((Z=t.settings)!=null&&Z.gemini_api_key.startsWith("AIza")),onClick:()=>{u.mutate({},{onSuccess:s=>p({title:"Success!",description:s.message})})},children:[u.isPending?e.jsx(g,{className:"h-5 w-5 animate-spin"}):e.jsx(qe,{className:"h-5 w-5"}),"Generate & Publish Now"]}),u.isPending&&e.jsxs("div",{className:"flex items-center justify-center gap-2 text-primary animate-pulse py-1",children:[e.jsx(de,{className:"h-3 w-3"}),e.jsx("span",{className:"text-[11px] font-medium italic",children:W[Ie]})]}),(!((Q=t.settings)!=null&&Q.gemini_api_key)||!((X=t.settings)!=null&&X.gemini_api_key.startsWith("AIza")))&&e.jsx("p",{className:"text-center text-xs text-destructive",children:"Please configure a valid API key first (starts with AIza)."})]})})]}),e.jsx(d,{children:e.jsxs(o,{className:"pt-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("div",{className:"flex items-center gap-2 font-semibold text-lg",children:[e.jsx(oe,{className:"h-5 w-5 text-primary"}),"Target Keywords & Topics"]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(x,{placeholder:"e.g. Benefits of Residential Proxies",className:"w-64",value:A,onChange:s=>K(s.target.value)}),e.jsxs(l,{onClick:()=>{A&&E.mutate({keyword:A,category:Be},{onSuccess:()=>K("")})},disabled:E.isPending||!A,children:[e.jsx(ne,{className:"h-4 w-4 mr-2"})," Add"]})]})]}),e.jsx("div",{className:"rounded-md border",children:e.jsxs(fe,{children:[e.jsx(ve,{children:e.jsxs(N,{children:[e.jsx(r,{children:"Topic / Keyword"}),e.jsx(r,{children:"Category"}),e.jsx(r,{children:"Last Used"}),e.jsx(r,{className:"text-right",children:"Action"})]})}),e.jsxs(ye,{children:[(J=t.keywords)==null?void 0:J.map(s=>e.jsxs(N,{children:[e.jsx(i,{className:"font-medium",children:s.keyword}),e.jsx(i,{children:e.jsx(je,{variant:"outline",className:"text-[10px]",children:s.category||"General"})}),e.jsx(i,{className:"text-xs text-muted-foreground",children:s.last_used_at?new Date(s.last_used_at).toLocaleDateString():"Never"}),e.jsx(i,{className:"text-right",children:e.jsx(l,{size:"icon",variant:"ghost",className:"h-8 w-8 text-destructive",onClick:()=>z.mutate(s.id),disabled:z.isPending,children:e.jsx(xe,{className:"h-3.5 w-3.5"})})})]},s.id)),(!t.keywords||t.keywords.length===0)&&e.jsx(N,{children:e.jsx(i,{colSpan:4,className:"h-24 text-center text-muted-foreground",children:"No keywords added yet. Add some to start auto-blogging."})})]})]})})]})})]})]}),e.jsx(ee,{open:Pe,onOpenChange:s=>{f(s),s||_()},children:e.jsxs(se,{className:"max-w-2xl",children:[e.jsxs(ae,{children:[e.jsx(te,{children:"Create New Article"}),e.jsx(le,{children:"Draft your post. You can publish it once it's saved."})]}),e.jsxs("div",{className:"space-y-4 py-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{children:"Title"}),e.jsx(x,{value:h,onChange:s=>y(s.target.value),placeholder:"Article headline..."})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{children:"Hero Image URL"}),e.jsx(x,{value:b,onChange:s=>C(s.target.value),placeholder:"https://..."})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{children:"Content (HTML/Text)"}),e.jsx(Ne,{value:m,onChange:s=>w(s.target.value),placeholder:"Write your article content here...",className:"min-h-[250px]"})]})]}),e.jsxs(ie,{children:[e.jsx(l,{variant:"outline",onClick:()=>f(!1),children:"Cancel"}),e.jsxs(l,{onClick:Le,disabled:B.isPending||!h||!m,children:[B.isPending?e.jsx(g,{className:"h-4 w-4 animate-spin mr-2"}):e.jsx(L,{className:"h-4 w-4 mr-2"}),"Save Draft"]})]})]})}),e.jsx(ee,{open:Ae,onOpenChange:s=>{v(s),s||_()},children:e.jsxs(se,{className:"max-w-2xl",children:[e.jsxs(ae,{children:[e.jsx(te,{children:"Edit Article"}),e.jsx(le,{children:"Update the content of your post."})]}),e.jsxs("div",{className:"space-y-4 py-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{children:"Title"}),e.jsx(x,{value:h,onChange:s=>y(s.target.value),placeholder:"Article headline..."})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{children:"Hero Image URL"}),e.jsx(x,{value:b,onChange:s=>C(s.target.value),placeholder:"https://..."})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{children:"Content (HTML/Text)"}),e.jsx(Ne,{value:m,onChange:s=>w(s.target.value),placeholder:"Write your article content here...",className:"min-h-[250px]"})]})]}),e.jsxs(ie,{children:[e.jsx(l,{variant:"outline",onClick:()=>v(!1),children:"Cancel"}),e.jsxs(l,{onClick:Ge,disabled:I.isPending||!h||!m,children:[I.isPending?e.jsx(g,{className:"h-4 w-4 animate-spin mr-2"}):e.jsx(L,{className:"h-4 w-4 mr-2"}),"Update Post"]})]})]})})]})]})}export{Cs as default};
