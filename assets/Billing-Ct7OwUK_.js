import{r as j,O as k,j as e,D as L,I as i,B as g,t as r,m as U,W as D,N as b,L as $}from"./index-BS3MrMDR.js";import{S as H}from"./SEOHead-CxpTJHm8.js";import{C as c,a as o,b as d,c as m}from"./card-DayAM_BL.js";import{T as M,a as R,b as p,c as x,d as F,e as l}from"./table-BLekKfgE.js";import{B as I}from"./badge-TlMpNj1c.js";import{L as h}from"./label-WpXwRrp2.js";import{S as O}from"./switch--UfaqjqZ.js";import{a as _,i as G,j as W,k as z}from"./use-backend-cpHbbH4Y.js";import{B as Y}from"./bitcoin-BI-3l_1s.js";import{R as q}from"./refresh-cw-CwAAmmmN.js";import"./useQuery-D_JWgd3B.js";import"./useMutation-BUadc-Ou.js";import"./api-BTF2QDx4.js";const J=[{id:"stripe",name:"Stripe",subtitle:"Credit/Debit Card",icon:U},{id:"paypal",name:"PayPal",subtitle:"PayPal Balance",icon:D},{id:"crypto",name:"Crypto",subtitle:"BTC, ETH, USDT",icon:Y}];function oe(){const{data:C,isLoading:T}=_(),{data:K}=G(),{data:t,isLoading:v}=W(),N=z(),[u,f]=j.useState("50"),{gateways:n,autoTopUpEnabled:w}=k(),[y,A]=j.useState(!1),[S,B]=j.useState("5"),E=async s=>{if(s!=="Stripe"){r({title:"Coming Soon",description:`${s} is not yet implemented.`});return}try{const a=parseFloat(u);if(isNaN(a)||a<5){r({title:"Invalid Amount",description:"Minimum top-up is $5.",variant:"destructive"});return}await N.mutateAsync({amount:a})}catch(a){r({title:"Checkout Error",description:a.message,variant:"destructive"})}},P=n.stripe||n.paypal||n.crypto;return e.jsxs(e.Fragment,{children:[e.jsx(H,{title:"Account & Billing",noindex:!0}),e.jsxs("div",{className:"space-y-6",children:[e.jsx("h1",{className:"text-2xl font-bold",children:"Account & Billing"}),e.jsxs(c,{children:[e.jsx(o,{children:e.jsxs(d,{className:"flex items-center gap-2 text-lg",children:[e.jsx(L,{className:"h-5 w-5"})," Add Balance"]})}),e.jsxs(m,{className:"space-y-4",children:[e.jsxs("div",{className:"grid gap-4 sm:grid-cols-2 max-w-lg",children:[e.jsxs("div",{className:"space-y-1.5",children:[e.jsx(h,{children:"Amount ($)"}),e.jsx(i,{type:"number",value:u,onChange:s=>f(s.target.value),min:"5",placeholder:"Enter amount"})]}),e.jsxs("div",{className:"space-y-1.5",children:[e.jsx(h,{children:"Promo Code (optional)"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(i,{placeholder:"WELCOME20"}),e.jsx(g,{variant:"outline",size:"sm",className:"shrink-0",onClick:()=>r({title:"Coupon Applied",description:"20% discount applied to your balance."}),children:"Apply"})]})]})]}),!P&&e.jsx("p",{className:"text-sm text-muted-foreground italic",children:"No payment methods are currently available. Please contact support."}),e.jsx("div",{className:"grid gap-3 sm:grid-cols-3",children:J.map(s=>{const a=n[s.id];return e.jsxs(g,{variant:a?"default":"outline",className:`h-auto py-4 flex-col gap-1 ${a?"":"opacity-40 cursor-not-allowed"}`,disabled:!a||N.isPending,onClick:()=>E(s.name),children:[e.jsx(s.icon,{className:"h-6 w-6"}),e.jsx("span",{className:"font-semibold",children:s.name}),e.jsx("span",{className:"text-[11px] font-normal opacity-80",children:s.subtitle}),!a&&e.jsx("span",{className:"text-[10px] font-normal",children:"Not available"})]},s.id)})})]})]}),w&&e.jsxs(c,{children:[e.jsx(o,{children:e.jsxs(d,{className:"flex items-center gap-2 text-lg",children:[e.jsx(q,{className:"h-5 w-5"})," Auto Top-Up"]})}),e.jsxs(m,{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium",children:"Enable Auto Top-Up"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Automatically add balance when it drops below the threshold"})]}),e.jsx(O,{checked:y,onCheckedChange:A})]}),y&&e.jsxs("div",{className:"grid gap-4 sm:grid-cols-2",children:[e.jsxs("div",{className:"space-y-1.5",children:[e.jsx(h,{children:"Min Balance Threshold ($)"}),e.jsx(i,{type:"number",value:S,onChange:s=>B(s.target.value)})]}),e.jsxs("div",{className:"space-y-1.5",children:[e.jsx(h,{children:"Top-Up Amount ($)"}),e.jsx(i,{type:"number",value:u,onChange:s=>f(s.target.value)})]})]})]})]}),e.jsx("div",{className:"grid gap-4 sm:grid-cols-3",children:T?Array(3).fill(0).map((s,a)=>e.jsx(b,{className:"h-40 w-full"},a)):(C??[]).map(s=>e.jsxs(c,{children:[e.jsx(o,{className:"pb-2",children:e.jsx(d,{className:"text-lg",children:s.name})}),e.jsxs(m,{className:"space-y-4",children:[e.jsxs("p",{className:"text-3xl font-bold",children:["€",Number(s.price).toFixed(2),e.jsx("span",{className:"text-base font-normal text-muted-foreground",children:"/GB"})]}),e.jsx(g,{variant:"default",className:"w-full",asChild:!0,children:e.jsx($,{to:"/app/proxies",children:"Generate Now"})})]})]},s.id))}),e.jsxs(c,{children:[e.jsx(o,{children:e.jsx(d,{className:"text-lg",children:"Recent Transactions"})}),e.jsx(m,{className:"p-0",children:e.jsxs(M,{children:[e.jsx(R,{children:e.jsxs(p,{children:[e.jsx(x,{children:"Type"}),e.jsx(x,{children:"Amount"}),e.jsx(x,{children:"Description"}),e.jsx(x,{className:"text-right",children:"Date"})]})}),e.jsx(F,{children:v?e.jsx(p,{children:e.jsx(l,{colSpan:4,children:e.jsx(b,{className:"h-20 w-full"})})}):(t==null?void 0:t.length)===0?e.jsx(p,{children:e.jsx(l,{colSpan:4,className:"text-center py-4 text-muted-foreground",children:"No transactions found."})}):t==null?void 0:t.map(s=>e.jsxs(p,{children:[e.jsx(l,{children:e.jsx(I,{variant:s.type==="credit"?"default":"secondary",children:s.type.toUpperCase()})}),e.jsxs(l,{className:s.type==="credit"?"text-green-600 font-bold":"",children:[s.type==="credit"?"+":"-","$",Number(s.amount).toFixed(2)]}),e.jsx(l,{className:"text-sm",children:s.description}),e.jsx(l,{className:"text-right text-sm text-muted-foreground",children:s.created_at?new Date(s.created_at).toLocaleDateString():"—"})]},s.id))})]})})]})]})]})}export{oe as default};
