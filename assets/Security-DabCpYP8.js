import{c as He,r as t,j as e,ac as ee,l as $e,S as Ge,a as z,f as ze,t as U,I as be}from"./index-C9jMBlim.js";import{S as Ue}from"./SEOHead-DkzPwOGL.js";import{C as oe,a as ie,b as ce,d as Ve,c as ue}from"./card-6a34pKAE.js";import{B as ye}from"./badge-Dk6P8aCe.js";import{L as Se}from"./label-Dn2CRHAY.js";import{j as qe}from"./use-backend-C8ZEQOAL.js";import{C as Qe}from"./copy-DmudpsRA.js";import{L as Je}from"./loader-circle-LpifAVqF.js";import"./useMutation-DF1wjGA5.js";import"./dashboard-BzpOr43j.js";/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ke=He("Dot",[["circle",{cx:"12.1",cy:"12.1",r:"1",key:"18d7e5"}]]);var Xe=Object.defineProperty,Ye=Object.defineProperties,Ze=Object.getOwnPropertyDescriptors,te=Object.getOwnPropertySymbols,Pe=Object.prototype.hasOwnProperty,Ee=Object.prototype.propertyIsEnumerable,Ce=(n,r,s)=>r in n?Xe(n,r,{enumerable:!0,configurable:!0,writable:!0,value:s}):n[r]=s,et=(n,r)=>{for(var s in r||(r={}))Pe.call(r,s)&&Ce(n,s,r[s]);if(te)for(var s of te(r))Ee.call(r,s)&&Ce(n,s,r[s]);return n},tt=(n,r)=>Ye(n,Ze(r)),nt=(n,r)=>{var s={};for(var o in n)Pe.call(n,o)&&r.indexOf(o)<0&&(s[o]=n[o]);if(n!=null&&te)for(var o of te(n))r.indexOf(o)<0&&Ee.call(n,o)&&(s[o]=n[o]);return s};function rt(n){let r=setTimeout(n,0),s=setTimeout(n,10),o=setTimeout(n,50);return[r,s,o]}function at(n){let r=t.useRef();return t.useEffect(()=>{r.current=n}),r.current}var st=18,Ne=40,lt=`${Ne}px`,ot=["[data-lastpass-icon-root]","com-1password-button","[data-dashlanecreated]",'[style$="2147483647 !important;"]'].join(",");function it({containerRef:n,inputRef:r,pushPasswordManagerStrategy:s,isFocused:o}){let[g,u]=t.useState(!1),[k,v]=t.useState(!1),[T,C]=t.useState(!1),A=t.useMemo(()=>s==="none"?!1:(s==="increase-width"||s==="experimental-no-flickering")&&g&&k,[g,k,s]),P=t.useCallback(()=>{let m=n.current,b=r.current;if(!m||!b||T||s==="none")return;let f=m,y=f.getBoundingClientRect().left+f.offsetWidth,M=f.getBoundingClientRect().top+f.offsetHeight/2,i=y-st,B=M;document.querySelectorAll(ot).length===0&&document.elementFromPoint(i,B)===m||(u(!0),C(!0))},[n,r,T,s]);return t.useEffect(()=>{let m=n.current;if(!m||s==="none")return;function b(){let y=window.innerWidth-m.getBoundingClientRect().right;v(y>=Ne)}b();let f=setInterval(b,1e3);return()=>{clearInterval(f)}},[n,s]),t.useEffect(()=>{let m=o||document.activeElement===r.current;if(s==="none"||!m)return;let b=setTimeout(P,0),f=setTimeout(P,2e3),y=setTimeout(P,5e3),M=setTimeout(()=>{C(!0)},6e3);return()=>{clearTimeout(b),clearTimeout(f),clearTimeout(y),clearTimeout(M)}},[r,o,s,P]),{hasPWMBadge:g,willPushPWMBadge:A,PWM_BADGE_SPACE_WIDTH:lt}}var ke=t.createContext({}),Te=t.forwardRef((n,r)=>{var s=n,{value:o,onChange:g,maxLength:u,textAlign:k="left",pattern:v,placeholder:T,inputMode:C="numeric",onComplete:A,pushPasswordManagerStrategy:P="increase-width",pasteTransformer:m,containerClassName:b,noScriptCSSFallback:f=ct,render:y,children:M}=s,i=nt(s,["value","onChange","maxLength","textAlign","pattern","placeholder","inputMode","onComplete","pushPasswordManagerStrategy","pasteTransformer","containerClassName","noScriptCSSFallback","render","children"]),B,X,R,de,pe;let[Re,Oe]=t.useState(typeof i.defaultValue=="string"?i.defaultValue:""),d=o??Re,D=at(d),V=t.useCallback(a=>{g==null||g(a),Oe(a)},[g]),E=t.useMemo(()=>v?typeof v=="string"?new RegExp(v):v:null,[v]),p=t.useRef(null),ne=t.useRef(null),re=t.useRef({value:d,onChange:V,isIOS:typeof window<"u"&&((X=(B=window==null?void 0:window.CSS)==null?void 0:B.supports)==null?void 0:X.call(B,"-webkit-touch-callout","none"))}),Y=t.useRef({prev:[(R=p.current)==null?void 0:R.selectionStart,(de=p.current)==null?void 0:de.selectionEnd,(pe=p.current)==null?void 0:pe.selectionDirection]});t.useImperativeHandle(r,()=>p.current,[]),t.useEffect(()=>{let a=p.current,l=ne.current;if(!a||!l)return;re.current.value!==a.value&&re.current.onChange(a.value),Y.current.prev=[a.selectionStart,a.selectionEnd,a.selectionDirection];function h(){if(document.activeElement!==a){Q(null),J(null);return}let c=a.selectionStart,x=a.selectionEnd,Z=a.selectionDirection,S=a.maxLength,W=a.value,N=Y.current.prev,O=-1,I=-1,L;if(W.length!==0&&c!==null&&x!==null){let We=c===x,Le=c===W.length&&W.length<S;if(We&&!Le){let _=c;if(_===0)O=0,I=1,L="forward";else if(_===S)O=_-1,I=_,L="backward";else if(S>1&&W.length>1){let le=0;if(N[0]!==null&&N[1]!==null){L=_<N[1]?"backward":"forward";let _e=N[0]===N[1]&&N[0]<S;L==="backward"&&!_e&&(le=-1)}O=le+_,I=le+_+1}}O!==-1&&I!==-1&&O!==I&&p.current.setSelectionRange(O,I,L)}let je=O!==-1?O:c,we=I!==-1?I:x,Fe=L??Z;Q(je),J(we),Y.current.prev=[je,we,Fe]}if(document.addEventListener("selectionchange",h,{capture:!0}),h(),document.activeElement===a&&ae(!0),!document.getElementById("input-otp-style")){let c=document.createElement("style");if(c.id="input-otp-style",document.head.appendChild(c),c.sheet){let x="background: transparent !important; color: transparent !important; border-color: transparent !important; opacity: 0 !important; box-shadow: none !important; -webkit-box-shadow: none !important; -webkit-text-fill-color: transparent !important;";K(c.sheet,"[data-input-otp]::selection { background: transparent !important; color: transparent !important; }"),K(c.sheet,`[data-input-otp]:autofill { ${x} }`),K(c.sheet,`[data-input-otp]:-webkit-autofill { ${x} }`),K(c.sheet,"@supports (-webkit-touch-callout: none) { [data-input-otp] { letter-spacing: -.6em !important; font-weight: 100 !important; font-stretch: ultra-condensed; font-optical-sizing: none !important; left: -1px !important; right: 1px !important; } }"),K(c.sheet,"[data-input-otp] + * { pointer-events: all !important; }")}}let j=()=>{l&&l.style.setProperty("--root-height",`${a.clientHeight}px`)};j();let w=new ResizeObserver(j);return w.observe(a),()=>{document.removeEventListener("selectionchange",h,{capture:!0}),w.disconnect()}},[]);let[me,he]=t.useState(!1),[q,ae]=t.useState(!1),[F,Q]=t.useState(null),[$,J]=t.useState(null);t.useEffect(()=>{rt(()=>{var a,l,h,j;(a=p.current)==null||a.dispatchEvent(new Event("input"));let w=(l=p.current)==null?void 0:l.selectionStart,c=(h=p.current)==null?void 0:h.selectionEnd,x=(j=p.current)==null?void 0:j.selectionDirection;w!==null&&c!==null&&(Q(w),J(c),Y.current.prev=[w,c,x])})},[d,q]),t.useEffect(()=>{D!==void 0&&d!==D&&D.length<u&&d.length===u&&(A==null||A(d))},[u,A,D,d]);let G=it({containerRef:ne,inputRef:p,pushPasswordManagerStrategy:P,isFocused:q}),fe=t.useCallback(a=>{let l=a.currentTarget.value.slice(0,u);if(l.length>0&&E&&!E.test(l)){a.preventDefault();return}typeof D=="string"&&l.length<D.length&&document.dispatchEvent(new Event("selectionchange")),V(l)},[u,V,D,E]),ve=t.useCallback(()=>{var a;if(p.current){let l=Math.min(p.current.value.length,u-1),h=p.current.value.length;(a=p.current)==null||a.setSelectionRange(l,h),Q(l),J(h)}ae(!0)},[u]),xe=t.useCallback(a=>{var l,h;let j=p.current;if(!m&&(!re.current.isIOS||!a.clipboardData||!j))return;let w=a.clipboardData.getData("text/plain"),c=m?m(w):w;a.preventDefault();let x=(l=p.current)==null?void 0:l.selectionStart,Z=(h=p.current)==null?void 0:h.selectionEnd,S=(x!==Z?d.slice(0,x)+c+d.slice(Z):d.slice(0,x)+c+d.slice(x)).slice(0,u);if(S.length>0&&E&&!E.test(S))return;j.value=S,V(S);let W=Math.min(S.length,u-1),N=S.length;j.setSelectionRange(W,N),Q(W),J(N)},[u,V,E,d]),Ie=t.useMemo(()=>({position:"relative",cursor:i.disabled?"default":"text",userSelect:"none",WebkitUserSelect:"none",pointerEvents:"none"}),[i.disabled]),ge=t.useMemo(()=>({position:"absolute",inset:0,width:G.willPushPWMBadge?`calc(100% + ${G.PWM_BADGE_SPACE_WIDTH})`:"100%",clipPath:G.willPushPWMBadge?`inset(0 ${G.PWM_BADGE_SPACE_WIDTH} 0 0)`:void 0,height:"100%",display:"flex",textAlign:k,opacity:"1",color:"transparent",pointerEvents:"all",background:"transparent",caretColor:"transparent",border:"0 solid transparent",outline:"0 solid transparent",boxShadow:"none",lineHeight:"1",letterSpacing:"-.5em",fontSize:"var(--root-height)",fontFamily:"monospace",fontVariantNumeric:"tabular-nums"}),[G.PWM_BADGE_SPACE_WIDTH,G.willPushPWMBadge,k]),Be=t.useMemo(()=>t.createElement("input",tt(et({autoComplete:i.autoComplete||"one-time-code"},i),{"data-input-otp":!0,"data-input-otp-placeholder-shown":d.length===0||void 0,"data-input-otp-mss":F,"data-input-otp-mse":$,inputMode:C,pattern:E==null?void 0:E.source,"aria-placeholder":T,style:ge,maxLength:u,value:d,ref:p,onPaste:a=>{var l;xe(a),(l=i.onPaste)==null||l.call(i,a)},onChange:fe,onMouseOver:a=>{var l;he(!0),(l=i.onMouseOver)==null||l.call(i,a)},onMouseLeave:a=>{var l;he(!1),(l=i.onMouseLeave)==null||l.call(i,a)},onFocus:a=>{var l;ve(),(l=i.onFocus)==null||l.call(i,a)},onBlur:a=>{var l;ae(!1),(l=i.onBlur)==null||l.call(i,a)}})),[fe,ve,xe,C,ge,u,$,F,i,E==null?void 0:E.source,d]),se=t.useMemo(()=>({slots:Array.from({length:u}).map((a,l)=>{var h;let j=q&&F!==null&&$!==null&&(F===$&&l===F||l>=F&&l<$),w=d[l]!==void 0?d[l]:null,c=d[0]!==void 0?null:(h=T==null?void 0:T[l])!=null?h:null;return{char:w,placeholderChar:c,isActive:j,hasFakeCaret:j&&w===null}}),isFocused:q,isHovering:!i.disabled&&me}),[q,me,u,$,F,i.disabled,d]),De=t.useMemo(()=>y?y(se):t.createElement(ke.Provider,{value:se},M),[M,se,y]);return t.createElement(t.Fragment,null,f!==null&&t.createElement("noscript",null,t.createElement("style",null,f)),t.createElement("div",{ref:ne,"data-input-otp-container":!0,style:Ie,className:b},De,t.createElement("div",{style:{position:"absolute",inset:0,pointerEvents:"none"}},Be)))});Te.displayName="Input";function K(n,r){try{n.insertRule(r)}catch{console.error("input-otp could not insert CSS rule:",r)}}var ct=`
[data-input-otp] {
  --nojs-bg: white !important;
  --nojs-fg: black !important;

  background-color: var(--nojs-bg) !important;
  color: var(--nojs-fg) !important;
  caret-color: var(--nojs-fg) !important;
  letter-spacing: .25em !important;
  text-align: center !important;
  border: 1px solid var(--nojs-fg) !important;
  border-radius: 4px !important;
  width: 100% !important;
}
@media (prefers-color-scheme: dark) {
  [data-input-otp] {
    --nojs-bg: black !important;
    --nojs-fg: white !important;
  }
}`;const Ae=t.forwardRef(({className:n,containerClassName:r,...s},o)=>e.jsx(Te,{ref:o,containerClassName:ee("flex items-center gap-2 has-[:disabled]:opacity-50",r),className:ee("disabled:cursor-not-allowed",n),...s}));Ae.displayName="InputOTP";const Me=t.forwardRef(({className:n,...r},s)=>e.jsx("div",{ref:s,className:ee("flex items-center",n),...r}));Me.displayName="InputOTPGroup";const H=t.forwardRef(({index:n,className:r,...s},o)=>{const g=t.useContext(ke),{char:u,hasFakeCaret:k,isActive:v}=g.slots[n];return e.jsxs("div",{ref:o,className:ee("relative flex h-10 w-10 items-center justify-center border-y border-r border-input text-sm transition-all first:rounded-l-md first:border-l last:rounded-r-md",v&&"z-10 ring-2 ring-ring ring-offset-background",r),...s,children:[u,k&&e.jsx("div",{className:"pointer-events-none absolute inset-0 flex items-center justify-center",children:e.jsx("div",{className:"animate-caret-blink h-4 w-px bg-foreground duration-1000"})})]})});H.displayName="InputOTPSlot";const ut=t.forwardRef(({...n},r)=>e.jsx("div",{ref:r,role:"separator",...n,children:e.jsx(Ke,{})}));ut.displayName="InputOTPSeparator";function bt(){const{user:n}=$e(),[r,s]=t.useState("idle"),[o,g]=t.useState(""),[u,k]=t.useState(!1),v="JBSWY3DPEHPK3PXP",T=qe(),[C,A]=t.useState(""),[P,m]=t.useState(""),[b,f]=t.useState(!1),y=async()=>{if(!C||C!==P){U({title:"Validation Error",description:"Passwords do not match.",variant:"destructive"});return}f(!0);try{await T.mutateAsync({password:C,password_confirmation:P}),U({title:"Password updated successfully"}),A(""),m("")}catch(R){U({title:"Error",description:R.message,variant:"destructive"})}finally{f(!1)}},M={mutate:()=>U({title:"2FA Setup",description:"This feature is coming soon to the self-hosted version."})},i=!1,B=()=>{if(o.length!==6){U({title:"Invalid code",description:"Enter a 6-digit code",variant:"destructive"});return}M.mutate()},X=`otpauth://totp/UpgradedProxy:${n==null?void 0:n.email}?secret=${v}&issuer=UpgradedProxy`;return e.jsxs(e.Fragment,{children:[e.jsx(Ue,{title:"Security & 2FA",noindex:!0}),e.jsxs("div",{className:"space-y-6",children:[e.jsx("h1",{className:"text-2xl font-bold",children:"Security & 2FA"}),e.jsxs(oe,{children:[e.jsx(ie,{children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(Ge,{className:"h-8 w-8 text-muted-foreground"}),e.jsxs("div",{children:[e.jsx(ce,{className:"text-lg",children:"Two-Factor Authentication (TOTP)"}),e.jsx(Ve,{children:"Add an extra layer of security using an authenticator app like Google Authenticator or Authy."})]}),e.jsx(ye,{variant:"secondary",className:"ml-auto",children:"Disabled"})]})}),e.jsxs(ue,{className:"space-y-4",children:[i,r==="idle"&&e.jsxs(z,{onClick:()=>s("setup"),children:[e.jsx(ze,{className:"mr-2 h-4 w-4"})," Enable 2FA"]}),r==="setup"&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("p",{className:"text-sm font-medium",children:"1. Scan this QR code with your authenticator app:"}),e.jsx("div",{className:"flex items-center justify-center rounded-lg border bg-white p-6",style:{maxWidth:240},children:e.jsx("img",{src:`https://api.qrserver.com/v1/create-qr-code/?size=200x200&data=${encodeURIComponent(X)}`,alt:"2FA QR Code",className:"w-48 h-48"})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("p",{className:"text-sm font-medium",children:"Or enter this secret manually:"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("code",{className:"bg-muted px-3 py-1.5 rounded text-sm font-mono",children:v}),e.jsx(z,{variant:"ghost",size:"icon",onClick:()=>{navigator.clipboard.writeText(v),U({title:"Copied"})},children:e.jsx(Qe,{className:"h-4 w-4"})})]})]}),e.jsx(z,{onClick:()=>s("verify"),children:"Next: Verify Code"})]}),r==="verify"&&e.jsxs("div",{className:"space-y-4",children:[e.jsx("p",{className:"text-sm font-medium",children:"2. Enter the 6-digit code from your authenticator app:"}),e.jsx(Ae,{maxLength:6,value:o,onChange:g,children:e.jsxs(Me,{children:[e.jsx(H,{index:0}),e.jsx(H,{index:1}),e.jsx(H,{index:2}),e.jsx(H,{index:3}),e.jsx(H,{index:4}),e.jsx(H,{index:5})]})}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(z,{variant:"outline",onClick:()=>{s("setup"),g("")},children:"Back"}),e.jsx(z,{onClick:B,disabled:o.length!==6,children:"Verify & Enable"})]})]})]})]}),e.jsxs(oe,{children:[e.jsx(ie,{children:e.jsx(ce,{className:"text-lg",children:"Change Password"})}),e.jsxs(ue,{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2 max-w-sm",children:[e.jsx(Se,{children:"New Password"}),e.jsx(be,{type:"password",placeholder:"••••••••",value:C,onChange:R=>A(R.target.value)})]}),e.jsxs("div",{className:"space-y-2 max-w-sm",children:[e.jsx(Se,{children:"Confirm New Password"}),e.jsx(be,{type:"password",placeholder:"••••••••",value:P,onChange:R=>m(R.target.value)})]}),e.jsxs(z,{onClick:y,disabled:b,children:[b?e.jsx(Je,{className:"mr-2 h-4 w-4 animate-spin"}):null,"Update Password"]})]})]}),e.jsxs(oe,{children:[e.jsx(ie,{children:e.jsx(ce,{className:"text-lg",children:"Active Sessions"})}),e.jsx(ue,{children:e.jsxs("div",{className:"flex items-center justify-between rounded-lg border p-3",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium",children:"Current Session"}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:["Browser • ",navigator.userAgent.split(" ").pop()]})]}),e.jsx(ye,{variant:"default",children:"Active"})]})})]})]})]})}export{bt as default};
