import{j as e,U as O,S as R,r as l,N as K,I as u,b as G,B as p,t as f}from"./index-BNuaxT4T.js";import{S as M}from"./SEOHead-BL8gBqiH.js";import{E as Y}from"./ErrorBanner-eicjdGF7.js";import{E as U}from"./EmptyState-m0LDsEaG.js";import{L as N}from"./label-BxnioONo.js";import{C as b,c as C,a as I,b as A}from"./card-DxanYWse.js";import{T as q,a as B,b as D,c as m,d as Z,e as x}from"./table-2junBFqZ.js";import{B as k}from"./badge-CCgDpgoq.js";import{T as V,a as J,b as E,c as L}from"./tabs-B9-fIx8S.js";import{D as Q,a as W,b as X,c as ee,d as se,e as ae,f as te}from"./dialog-CmmdZ89q.js";import{e as le,f as re}from"./use-backend-DejpU3i6.js";import{K as $}from"./key-BiFt9LXk.js";import{P as z}from"./plus-Bc07IGCV.js";import{T as H}from"./trash-2-JA-Cv5HQ.js";import{C as ie}from"./copy-BxtNAHx0.js";import"./circle-alert-CghHbpmH.js";import"./useQuery-CBgvpg-m.js";import"./useMutation-CQc9H_Pl.js";import"./api-BTF2QDx4.js";const ne=[{id:"1",ip:"203.0.113.42",label:"Production server",created_at:"2026-02-10T10:00:00Z"},{id:"2",ip:"198.51.100.7",label:"Staging",created_at:"2026-02-15T14:00:00Z"}],ce=[{id:"1",name:"Production",key_prefix:"upx_prod_****",allowed_countries:["US","UK"],daily_gb_cap:50,daily_request_cap:1e5,allowed_scopes:["proxy:generate","usage:read"],created_at:"2026-01-20T10:00:00Z",last_used_at:"2026-02-20T08:30:00Z"},{id:"2",name:"Testing",key_prefix:"upx_test_****",allowed_countries:[],daily_gb_cap:5,daily_request_cap:1e4,allowed_scopes:["proxy:generate"],created_at:"2026-02-01T12:00:00Z",last_used_at:null}];function Ke(){return e.jsxs(e.Fragment,{children:[e.jsx(M,{title:"Settings",noindex:!0}),e.jsxs("div",{className:"space-y-6",children:[e.jsx("h1",{className:"text-2xl font-bold",children:"Settings"}),e.jsxs(V,{defaultValue:"allowlist",children:[e.jsxs(J,{children:[e.jsxs(E,{value:"profile",children:[e.jsx(O,{className:"mr-1 h-3.5 w-3.5"})," Profile"]}),e.jsxs(E,{value:"allowlist",children:[e.jsx(R,{className:"mr-1 h-3.5 w-3.5"})," IP Allowlist"]}),e.jsxs(E,{value:"api-keys",children:[e.jsx($,{className:"mr-1 h-3.5 w-3.5"})," API Keys"]})]}),e.jsx(L,{value:"profile",className:"mt-4",children:e.jsx(xe,{})}),e.jsx(L,{value:"allowlist",className:"mt-4",children:e.jsx(de,{})}),e.jsx(L,{value:"api-keys",className:"mt-4",children:e.jsx(me,{})})]})]})]})}function de(){const[t,v]=l.useState(ne),[j,w]=l.useState(""),[i,c]=l.useState(""),[h,n]=l.useState(null),g=()=>{n(null);const a=j.trim();if(!a){n("IP address is required.");return}if(!/^\d{1,3}(\.\d{1,3}){3}(\/\d{1,2})?$/.test(a)){n("Enter a valid IPv4 address or CIDR range.");return}const y={id:Date.now().toString(),ip:a,label:i.trim()||void 0,created_at:new Date().toISOString()};v(r=>[...r,y]),w(""),c(""),f({title:"IP Added",description:`${a} added to allowlist.`})},_=a=>{v(y=>y.filter(r=>r.id!==a)),f({title:"Removed",description:"IP removed from allowlist."})};return e.jsxs(b,{children:[e.jsx(I,{children:e.jsx(A,{className:"text-lg",children:"IP Allowlist"})}),e.jsxs(C,{className:"space-y-4",children:[h&&e.jsx(Y,{message:h,onDismiss:()=>n(null)}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(u,{placeholder:"203.0.113.0/24",value:j,onChange:a=>w(a.target.value),className:"max-w-xs"}),e.jsx(u,{placeholder:"Label (optional)",value:i,onChange:a=>c(a.target.value),className:"max-w-xs"}),e.jsxs(p,{onClick:g,children:[e.jsx(z,{className:"mr-1 h-4 w-4"})," Add"]})]}),t.length===0?e.jsx(U,{icon:R,title:"No IPs allowlisted",description:"Add your server IPs to authenticate without credentials."}):e.jsxs(q,{children:[e.jsx(B,{children:e.jsxs(D,{children:[e.jsx(m,{children:"IP Address"}),e.jsx(m,{children:"Label"}),e.jsx(m,{children:"Added"}),e.jsx(m,{className:"w-12"})]})}),e.jsx(Z,{children:t.map(a=>e.jsxs(D,{children:[e.jsx(x,{className:"font-mono text-sm",children:a.ip}),e.jsx(x,{className:"text-sm text-muted-foreground",children:a.label??"—"}),e.jsx(x,{className:"text-xs text-muted-foreground",children:new Date(a.created_at).toLocaleDateString()}),e.jsx(x,{children:e.jsx(p,{variant:"ghost",size:"icon",onClick:()=>_(a.id),"aria-label":"Remove",children:e.jsx(H,{className:"h-4 w-4 text-destructive"})})})]},a.id))})]})]})]})}const oe=["proxy:generate","usage:read","allowlist:manage","keys:manage"];function me(){const[t,v]=l.useState(ce),[j,w]=l.useState(null),[i,c]=l.useState(""),[h,n]=l.useState(""),[g,_]=l.useState(""),[a,y]=l.useState(""),[r,S]=l.useState(["proxy:generate"]),P=s=>{S(d=>d.includes(s)?d.filter(o=>o!==s):[...d,s])},T=()=>{if(!i.trim())return;const s=`upx_${i.toLowerCase().replace(/\s/g,"_")}_${Math.random().toString(36).slice(2,14)}`,d={id:Date.now().toString(),name:i.trim(),key_prefix:s.slice(0,12)+"****",allowed_countries:h?h.split(",").map(o=>o.trim().toUpperCase()):[],daily_gb_cap:g?Number(g):null,daily_request_cap:a?Number(a):null,allowed_scopes:r,created_at:new Date().toISOString(),last_used_at:null};v(o=>[...o,d]),w(s),c(""),n(""),_(""),y(""),S(["proxy:generate"]),f({title:"API Key Created",description:"Copy it now — it won't be shown again."})},F=s=>{v(d=>d.filter(o=>o.id!==s)),f({title:"Revoked",description:"API key has been revoked."})};return e.jsxs("div",{className:"space-y-4",children:[j&&e.jsx(b,{className:"border-primary",children:e.jsxs(C,{className:"flex items-center justify-between gap-4 py-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium",children:"Your new API key (copy now — shown once):"}),e.jsx("code",{className:"mt-1 block text-xs font-mono text-primary",children:j})]}),e.jsxs(p,{variant:"outline",size:"sm",onClick:()=>{navigator.clipboard.writeText(j),f({title:"Copied"})},children:[e.jsx(ie,{className:"mr-1 h-3.5 w-3.5"})," Copy"]})]})}),e.jsxs(b,{children:[e.jsxs(I,{className:"flex flex-row items-center justify-between",children:[e.jsx(A,{className:"text-lg",children:"API Keys"}),e.jsxs(Q,{children:[e.jsx(W,{asChild:!0,children:e.jsxs(p,{size:"sm",children:[e.jsx(z,{className:"mr-1 h-4 w-4"})," Create Key"]})}),e.jsxs(X,{children:[e.jsx(ee,{children:e.jsx(se,{children:"Create API Key"})}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(N,{children:"Key Name"}),e.jsx(u,{value:i,onChange:s=>c(s.target.value),placeholder:"Production"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(N,{children:"Allowed Countries (comma-separated, optional)"}),e.jsx(u,{value:h,onChange:s=>n(s.target.value),placeholder:"US, UK, DE"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(N,{children:"Daily GB Cap"}),e.jsx(u,{type:"number",value:g,onChange:s=>_(s.target.value),placeholder:"No limit"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(N,{children:"Daily Request Cap"}),e.jsx(u,{type:"number",value:a,onChange:s=>y(s.target.value),placeholder:"No limit"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(N,{children:"Scopes"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:oe.map(s=>e.jsx(k,{variant:r.includes(s)?"default":"outline",className:"cursor-pointer",onClick:()=>P(s),children:s},s))})]})]}),e.jsxs(ae,{children:[e.jsx(te,{asChild:!0,children:e.jsx(p,{variant:"outline",children:"Cancel"})}),e.jsx(p,{onClick:T,disabled:!i.trim(),children:"Create"})]})]})]})]}),e.jsx(C,{className:"p-0",children:t.length===0?e.jsx("div",{className:"p-6",children:e.jsx(U,{icon:$,title:"No API keys",description:"Create a key to access the UpgradedProxy API programmatically."})}):e.jsxs(q,{children:[e.jsx(B,{children:e.jsxs(D,{children:[e.jsx(m,{children:"Name"}),e.jsx(m,{children:"Key"}),e.jsx(m,{children:"Scopes"}),e.jsx(m,{children:"Limits"}),e.jsx(m,{children:"Last Used"}),e.jsx(m,{className:"w-12"})]})}),e.jsx(Z,{children:t.map(s=>{var d;return e.jsxs(D,{children:[e.jsx(x,{className:"font-medium text-sm",children:s.name}),e.jsx(x,{className:"font-mono text-xs",children:s.key_prefix}),e.jsx(x,{children:e.jsx("div",{className:"flex flex-wrap gap-1",children:(d=s.allowed_scopes)==null?void 0:d.map(o=>e.jsx(k,{variant:"secondary",className:"text-[10px]",children:o},o))})}),e.jsxs(x,{className:"text-xs text-muted-foreground",children:[s.daily_gb_cap?`${s.daily_gb_cap} GB/d`:"—",s.daily_request_cap?` / ${s.daily_request_cap.toLocaleString()} req/d`:""]}),e.jsx(x,{className:"text-xs text-muted-foreground",children:s.last_used_at?new Date(s.last_used_at).toLocaleDateString():"Never"}),e.jsx(x,{children:e.jsx(p,{variant:"ghost",size:"icon",onClick:()=>F(s.id),"aria-label":"Revoke",children:e.jsx(H,{className:"h-4 w-4 text-destructive"})})})]},s.id)})})]})})]})]})}function xe(){const{data:t,isLoading:v}=le(),j=re(),[w,i]=l.useState(""),[c,h]=l.useState(""),[n,g]=l.useState(""),[_,a]=l.useState(!1);l.useState(()=>{t!=null&&t.name&&i(t.name)});const y=async r=>{var S,P;if(r.preventDefault(),c&&c!==n){f({title:"Error",description:"Passwords do not match.",variant:"destructive"});return}a(!0);try{await j.mutateAsync({name:w||void 0,password:c||void 0,password_confirmation:n||void 0}),f({title:"Success",description:"Profile updated successfully."}),h(""),g("")}catch(T){f({title:"Error",description:((P=(S=T.response)==null?void 0:S.data)==null?void 0:P.message)||"Failed to update profile.",variant:"destructive"})}finally{a(!1)}};return v?e.jsx(b,{children:e.jsxs(C,{className:"pt-6 space-y-4",children:[e.jsx(K,{className:"h-10 w-full"}),e.jsx(K,{className:"h-10 w-full"}),e.jsx(K,{className:"h-10 w-24"})]})}):e.jsxs("div",{className:"grid gap-6",children:[e.jsxs(b,{children:[e.jsx(I,{children:e.jsx(A,{className:"text-lg",children:"Account Details"})}),e.jsx(C,{children:e.jsxs("form",{onSubmit:y,className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(N,{children:"Email Address"}),e.jsx(u,{value:t==null?void 0:t.email,disabled:!0,className:"bg-muted"}),e.jsx("p",{className:"text-[10px] text-muted-foreground",children:"Email cannot be changed manually. Contact support for assistance."})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(N,{children:"Display Name"}),e.jsx(u,{value:w||(t==null?void 0:t.name)||"",onChange:r=>i(r.target.value),placeholder:"Full Name"})]}),e.jsx("hr",{className:"my-6 border-border"}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(G,{className:"h-4 w-4 text-muted-foreground"}),e.jsx(N,{children:"Change Password"})]}),e.jsxs("div",{className:"grid gap-4 sm:grid-cols-2",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx(u,{type:"password",placeholder:"New Password",value:c,onChange:r=>h(r.target.value)}),e.jsx("p",{className:"text-[10px] text-muted-foreground text-center",children:"Minimum 8 characters"})]}),e.jsx(u,{type:"password",placeholder:"Confirm New Password",value:n,onChange:r=>g(r.target.value)})]})]}),e.jsx(p,{type:"submit",disabled:_,children:_?"Saving...":"Save Changes"})]})})]}),e.jsxs(b,{children:[e.jsx(I,{children:e.jsx(A,{className:"text-lg",children:"Danger Zone"})}),e.jsx(C,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium",children:"Delete Account"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Permanently delete your account and all associated data."})]}),e.jsx(p,{variant:"destructive",size:"sm",children:"Delete Account"})]})})]})]})}export{Ke as default};
