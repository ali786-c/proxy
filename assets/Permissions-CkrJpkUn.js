import{U as g,r as y,V as C,j as e,S as N,a as S,I as v,x as b,y as T,z as w,E,J as h,t as u,ae as j,af as R,o as U,s as n,aj as A,ah as L}from"./index-BKJm8pJi.js";import{S as q}from"./SEOHead-xZzqqwPL.js";import{C as B,a as H,b as I,c as M}from"./card-C3T-gKet.js";import{B as Q}from"./badge-6V-fyefH.js";import{T as z,a as F,b as t,c as i,d as K,e as r}from"./table-Breyvx2s.js";import{u as P}from"./useMutation-B9a5FYcM.js";import{R as V}from"./refresh-cw-Ca1QNGN_.js";import{S as k}from"./search-DuVRdCFy.js";const J=U({id:A(),name:n().nullable(),email:n(),role:n()});function _(){const c=g(),[l,p]=y.useState(""),{data:f=[],isLoading:o}=C({queryKey:["admin-users-roles"],queryFn:()=>j.get("/admin/users",L(J))}),d=P({mutationFn:({userId:s,role:a})=>j.post(`/admin/users/${s}/role`,R,{role:a}),onSuccess:()=>{c.invalidateQueries({queryKey:["admin-users-roles"]}),u({title:"Role Updated",description:"User permissions have been modified."})},onError:s=>u({title:"Error",description:s.message,variant:"destructive"})}),m=f.filter(s=>{var a,x;return((a=s.name)==null?void 0:a.toLowerCase().includes(l.toLowerCase()))||((x=s.email)==null?void 0:x.toLowerCase().includes(l.toLowerCase()))});return e.jsxs(e.Fragment,{children:[e.jsx(q,{title:"Admin â€” User Permissions",noindex:!0}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs("h1",{className:"text-2xl font-bold flex items-center gap-2",children:[e.jsx(N,{className:"h-6 w-6"})," User Roles"]}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Manage administrative access for system users."})]}),e.jsx(S,{variant:"ghost",size:"icon",onClick:()=>c.invalidateQueries({queryKey:["admin-users-roles"]}),children:e.jsx(V,{className:"h-4 w-4"})})]}),e.jsxs("div",{className:"relative max-w-sm",children:[e.jsx(k,{className:"absolute left-3 top-1/2 h-4 w-4 -translate-y-1/2 text-muted-foreground"}),e.jsx(v,{placeholder:"Search by name or email...",value:l,onChange:s=>p(s.target.value),className:"pl-9"})]}),e.jsxs(B,{children:[e.jsx(H,{children:e.jsx(I,{children:"Access Control"})}),e.jsx(M,{className:"p-0",children:e.jsxs(z,{children:[e.jsx(F,{children:e.jsxs(t,{children:[e.jsx(i,{children:"User"}),e.jsx(i,{children:"Email"}),e.jsx(i,{children:"Current Role"}),e.jsx(i,{className:"text-right",children:"Actions"})]})}),e.jsxs(K,{children:[o?e.jsx(t,{children:e.jsx(r,{colSpan:4,className:"h-24 text-center",children:"Loading users..."})}):m.map(s=>e.jsxs(t,{children:[e.jsx(r,{className:"font-medium",children:s.name||"N/A"}),e.jsx(r,{className:"text-sm",children:s.email}),e.jsx(r,{children:e.jsx(Q,{variant:s.role==="admin"?"default":"secondary",className:"capitalize",children:s.role})}),e.jsx(r,{className:"text-right",children:e.jsxs(b,{value:s.role,onValueChange:a=>d.mutate({userId:s.id,role:a}),disabled:d.isPending,children:[e.jsx(T,{className:"w-[120px] ml-auto h-8 text-xs",children:e.jsx(w,{})}),e.jsxs(E,{children:[e.jsx(h,{value:"client",children:"Client"}),e.jsx(h,{value:"admin",children:"Admin"})]})]})})]},s.id)),!o&&m.length===0&&e.jsx(t,{children:e.jsx(r,{colSpan:4,className:"h-24 text-center text-muted-foreground",children:"No users found."})})]})]})})]})]})]})}export{_ as default};
