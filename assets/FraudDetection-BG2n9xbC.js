import{r as k,aa as L,j as e,aI as A,q as R,v as M,w as F,x as q,y as u,B as I,t as D}from"./index-BuE-Xh2G.js";import{u as N}from"./useQuery-D__W1Jha.js";import{u as $}from"./useMutation-D-rObiQR.js";import{C as c,a as o,b as h,c as d}from"./card-6TtDi5Gl.js";import{B as m}from"./badge-BbTNflPw.js";import{T as j,a as g,b as i,c as t,d as f,e as l}from"./table-CuLP2xy1.js";import{T as B,a as H,b as p,c as v}from"./tabs-DlyK8Mjw.js";import{C as U}from"./circle-check-big-BeQWDg2Q.js";import{f as y}from"./format-sbWH3_uq.js";const b={low:"bg-blue-500/10 text-blue-500",medium:"bg-yellow-500/10 text-yellow-500",high:"bg-orange-500/10 text-orange-500",critical:"bg-destructive/10 text-destructive"},E={login_anomaly:"Login Anomaly",usage_spike:"Usage Spike",impossible_travel:"Impossible Travel",rapid_auth:"Rapid Auth Attempts"};function K(x){return N({queryKey:["fraud-signals",x],queryFn:async()=>[]})}function V(){return N({queryKey:["risk-scores"],queryFn:async()=>[]})}function Q(){return N({queryKey:["login-history"],queryFn:async()=>[]})}function se(){const[x,_]=k.useState("unresolved"),{data:r,isLoading:O}=K(x),{data:a}=V(),{data:n}=Q(),S=L(),C=$({mutationFn:async s=>{},onSuccess:()=>{S.invalidateQueries({queryKey:["fraud-signals"]}),D({title:"Signal resolved (Mock)"})}}),T=(r==null?void 0:r.filter(s=>s.severity==="critical"&&!s.is_resolved).length)??0,w=(a==null?void 0:a.filter(s=>s.risk_score>=70).length)??0;return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsxs("h1",{className:"text-2xl font-bold flex items-center gap-2",children:[e.jsx(A,{className:"h-6 w-6"})," Fraud Detection"]}),e.jsx("p",{className:"text-muted-foreground",children:"Monitor login anomalies, usage abuse, and risk scores"})]}),e.jsxs("div",{className:"grid gap-4 md:grid-cols-4",children:[e.jsxs(c,{children:[e.jsx(o,{className:"pb-2",children:e.jsx(h,{className:"text-sm font-medium text-muted-foreground",children:"Active Signals"})}),e.jsx(d,{children:e.jsx("div",{className:"text-2xl font-bold",children:(r==null?void 0:r.filter(s=>!s.is_resolved).length)??0})})]}),e.jsxs(c,{children:[e.jsx(o,{className:"pb-2",children:e.jsx(h,{className:"text-sm font-medium text-muted-foreground",children:"Critical Alerts"})}),e.jsx(d,{children:e.jsx("div",{className:"text-2xl font-bold text-destructive",children:T})})]}),e.jsxs(c,{children:[e.jsx(o,{className:"pb-2",children:e.jsx(h,{className:"text-sm font-medium text-muted-foreground",children:"High-Risk Users"})}),e.jsx(d,{children:e.jsx("div",{className:"text-2xl font-bold text-warning",children:w})})]}),e.jsxs(c,{children:[e.jsx(o,{className:"pb-2",children:e.jsx(h,{className:"text-sm font-medium text-muted-foreground",children:"Login Events (24h)"})}),e.jsx(d,{children:e.jsx("div",{className:"text-2xl font-bold",children:(n==null?void 0:n.length)??0})})]})]}),e.jsxs(B,{defaultValue:"signals",children:[e.jsxs(H,{children:[e.jsx(p,{value:"signals",children:"Fraud Signals"}),e.jsx(p,{value:"risk",children:"Risk Scores"}),e.jsx(p,{value:"logins",children:"Login History"})]}),e.jsxs(v,{value:"signals",className:"space-y-4",children:[e.jsx("div",{className:"flex justify-end",children:e.jsxs(R,{value:x,onValueChange:_,children:[e.jsx(M,{className:"w-[180px]",children:e.jsx(F,{})}),e.jsxs(q,{children:[e.jsx(u,{value:"all",children:"All Signals"}),e.jsx(u,{value:"unresolved",children:"Unresolved"}),e.jsx(u,{value:"resolved",children:"Resolved"})]})]})}),e.jsx(c,{children:e.jsx(d,{className:"pt-6",children:e.jsxs(j,{children:[e.jsx(g,{children:e.jsxs(i,{children:[e.jsx(t,{children:"Type"}),e.jsx(t,{children:"Severity"}),e.jsx(t,{children:"Description"}),e.jsx(t,{children:"Location"}),e.jsx(t,{children:"IP"}),e.jsx(t,{children:"Time"}),e.jsx(t,{children:"Actions"})]})}),e.jsxs(f,{children:[r==null?void 0:r.map(s=>e.jsxs(i,{children:[e.jsx(l,{children:e.jsx(m,{variant:"outline",children:E[s.signal_type]??s.signal_type})}),e.jsx(l,{children:e.jsx("span",{className:`rounded px-2 py-0.5 text-xs font-semibold ${b[s.severity]??""}`,children:s.severity})}),e.jsx(l,{className:"max-w-[200px] truncate",children:s.description}),e.jsx(l,{children:s.geo_city?`${s.geo_city}, ${s.geo_country}`:s.geo_country??"—"}),e.jsx(l,{className:"font-mono text-xs",children:s.ip_address??"—"}),e.jsx(l,{className:"text-xs",children:y(new Date(s.created_at),"MMM d, HH:mm")}),e.jsx(l,{children:s.is_resolved?e.jsx(m,{variant:"secondary",children:"Resolved"}):e.jsxs(I,{size:"sm",variant:"outline",onClick:()=>C.mutate(s.id),children:[e.jsx(U,{className:"mr-1 h-3 w-3"})," Resolve"]})})]},s.id)),!(r!=null&&r.length)&&e.jsx(i,{children:e.jsx(l,{colSpan:7,className:"text-center text-muted-foreground py-8",children:"No fraud signals detected"})})]})]})})})]}),e.jsx(v,{value:"risk",children:e.jsx(c,{children:e.jsx(d,{className:"pt-6",children:e.jsxs(j,{children:[e.jsx(g,{children:e.jsxs(i,{children:[e.jsx(t,{children:"User ID"}),e.jsx(t,{children:"Risk Score"}),e.jsx(t,{children:"Level"}),e.jsx(t,{children:"Factors"}),e.jsx(t,{children:"Last Calculated"})]})}),e.jsxs(f,{children:[a==null?void 0:a.map(s=>e.jsxs(i,{children:[e.jsxs(l,{className:"font-mono text-xs",children:[s.user_id.slice(0,8),"…"]}),e.jsx(l,{children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"h-2 w-16 rounded-full bg-muted overflow-hidden",children:e.jsx("div",{className:`h-full rounded-full ${s.risk_score>=70?"bg-destructive":s.risk_score>=40?"bg-yellow-500":"bg-green-500"}`,style:{width:`${s.risk_score}%`}})}),e.jsx("span",{className:"text-sm font-semibold",children:s.risk_score})]})}),e.jsx(l,{children:e.jsx("span",{className:`rounded px-2 py-0.5 text-xs font-semibold ${b[s.risk_level]??""}`,children:s.risk_level})}),e.jsx(l,{className:"text-xs",children:Array.isArray(s.factors)?s.factors.join(", "):"—"}),e.jsx(l,{className:"text-xs",children:y(new Date(s.last_calculated_at),"MMM d, HH:mm")})]},s.id)),!(a!=null&&a.length)&&e.jsx(i,{children:e.jsx(l,{colSpan:5,className:"text-center text-muted-foreground py-8",children:"No risk scores calculated yet"})})]})]})})})}),e.jsx(v,{value:"logins",children:e.jsx(c,{children:e.jsx(d,{className:"pt-6",children:e.jsxs(j,{children:[e.jsx(g,{children:e.jsxs(i,{children:[e.jsx(t,{children:"User ID"}),e.jsx(t,{children:"Status"}),e.jsx(t,{children:"IP"}),e.jsx(t,{children:"Location"}),e.jsx(t,{children:"User Agent"}),e.jsx(t,{children:"Time"})]})}),e.jsxs(f,{children:[n==null?void 0:n.map(s=>e.jsxs(i,{children:[e.jsxs(l,{className:"font-mono text-xs",children:[s.user_id.slice(0,8),"…"]}),e.jsx(l,{children:e.jsx(m,{variant:s.success?"default":"destructive",children:s.success?"Success":"Failed"})}),e.jsx(l,{className:"font-mono text-xs",children:s.ip_address??"—"}),e.jsx(l,{children:s.geo_city?`${s.geo_city}, ${s.geo_country}`:s.geo_country??"—"}),e.jsx(l,{className:"max-w-[150px] truncate text-xs",children:s.user_agent??"—"}),e.jsx(l,{className:"text-xs",children:y(new Date(s.created_at),"MMM d, HH:mm")})]},s.id)),!(n!=null&&n.length)&&e.jsx(i,{children:e.jsx(l,{colSpan:6,className:"text-center text-muted-foreground py-8",children:"No login events recorded"})})]})]})})})})]})]})}export{se as default};
