import{ad as g,ac as d,j as e,d as y,t as m}from"./index-DTmX-7Ix.js";import{S as b}from"./SEOHead-UEUc3vr9.js";import{C,a as N,b as q,c as w}from"./card-DERAon_o.js";import{B as T}from"./badge-DvtB9Fp3.js";import{S as v}from"./switch-jt5z2rAf.js";import{T as P,a as S,b as x,c as o,d as _,e as c}from"./table-h-rXNTxZ.js";import{u as B}from"./useMutation-CdwqAdAS.js";function Q(){const u=g(),{data:t}=d({queryKey:["permissions"],queryFn:async()=>[]}),{data:n}=d({queryKey:["role-permissions"],queryFn:async()=>[]}),p=B({mutationFn:async({role:a,permissionId:s,enabled:r})=>{if(r){const{error:i}=await supabase.from("role_permissions").insert({role:a,permission_id:s});if(i)throw i}else{const{error:i}=await supabase.from("role_permissions").delete().eq("role",a).eq("permission_id",s);if(i)throw i}},onSuccess:()=>{u.invalidateQueries({queryKey:["role-permissions"]}),m({title:"Permission Updated"})},onError:a=>m({title:"Error",description:a.message,variant:"destructive"})}),h=(a,s)=>(n==null?void 0:n.some(r=>r.role===a&&r.permission_id===s))??!1,j=[...new Set((t==null?void 0:t.map(a=>a.category))??[])],l=["admin","client"],f={proxy:"ðŸŒ",billing:"ðŸ’³",support:"ðŸŽ§",users:"ðŸ‘¥",api:"ðŸ”‘",audit:"ðŸ“‹",settings:"âš™ï¸",org:"ðŸ¢"};return e.jsxs(e.Fragment,{children:[e.jsx(b,{title:"Admin â€” Permissions",noindex:!0}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsxs("h1",{className:"text-2xl font-bold flex items-center gap-2",children:[e.jsx(y,{className:"h-6 w-6"})," Role Permissions (RBAC)"]}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Manage granular permissions for each role."})]}),j.map(a=>e.jsxs(C,{children:[e.jsx(N,{children:e.jsxs(q,{className:"text-lg flex items-center gap-2",children:[e.jsx("span",{children:f[a]??"ðŸ“¦"}),e.jsx("span",{className:"capitalize",children:a})]})}),e.jsx(w,{className:"p-0",children:e.jsxs(P,{children:[e.jsx(S,{children:e.jsxs(x,{children:[e.jsx(o,{children:"Permission"}),e.jsx(o,{children:"Description"}),l.map(s=>e.jsx(o,{className:"text-center capitalize",children:s},s))]})}),e.jsx(_,{children:t==null?void 0:t.filter(s=>s.category===a).map(s=>e.jsxs(x,{children:[e.jsx(c,{children:e.jsx(T,{variant:"outline",className:"font-mono text-xs",children:s.name})}),e.jsx(c,{className:"text-sm text-muted-foreground",children:s.description}),l.map(r=>e.jsx(c,{className:"text-center",children:e.jsx(v,{checked:h(r,s.id),onCheckedChange:i=>p.mutate({role:r,permissionId:s.id,enabled:i}),disabled:r==="admin"})},r))]},s.id))})]})})]},a))]})]})}export{Q as default};
