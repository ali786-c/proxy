import{a3 as g,r as y,a4 as C,j as e,S as N,a as S,I as v,k as b,J as T,K as w,N as R,O as q,P as h,t as u,at as j,av as A,q as E,s as n,aR as L,ay as U}from"./index-Rj6KsRZ3.js";import{S as H}from"./SEOHead-Cp9_LOLn.js";import{C as I,a as K,b as M,c as P}from"./card-CN5fxAhF.js";import{T as Q,a as B,b as t,c as i,d as F,e as r}from"./table-DNF0uc6k.js";import{u as k}from"./useMutation-obzcPQ9v.js";import{R as z}from"./refresh-cw-DWGuf9gg.js";import{S as O}from"./search-BGJAz2a0.js";const V=E({id:L(),name:n().nullable(),email:n(),role:n()});function Z(){const c=g(),[l,p]=y.useState(""),{data:f=[],isLoading:d}=C({queryKey:["admin-users-roles"],queryFn:()=>j.get("/admin/users",U(V))}),o=k({mutationFn:({userId:s,role:a})=>j.post(`/admin/users/${s}/role`,A,{role:a}),onSuccess:()=>{c.invalidateQueries({queryKey:["admin-users-roles"]}),u({title:"Role Updated",description:"User permissions have been modified."})},onError:s=>u({title:"Error",description:s.message,variant:"destructive"})}),m=f.filter(s=>{var a,x;return((a=s.name)==null?void 0:a.toLowerCase().includes(l.toLowerCase()))||((x=s.email)==null?void 0:x.toLowerCase().includes(l.toLowerCase()))});return e.jsxs(e.Fragment,{children:[e.jsx(H,{title:"Admin â€” User Permissions",noindex:!0}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs("h1",{className:"text-2xl font-bold flex items-center gap-2",children:[e.jsx(N,{className:"h-6 w-6"})," User Roles"]}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Manage administrative access for system users."})]}),e.jsx(S,{variant:"ghost",size:"icon",onClick:()=>c.invalidateQueries({queryKey:["admin-users-roles"]}),children:e.jsx(z,{className:"h-4 w-4"})})]}),e.jsxs("div",{className:"relative max-w-sm",children:[e.jsx(O,{className:"absolute left-3 top-1/2 h-4 w-4 -translate-y-1/2 text-muted-foreground"}),e.jsx(v,{placeholder:"Search by name or email...",value:l,onChange:s=>p(s.target.value),className:"pl-9"})]}),e.jsxs(I,{children:[e.jsx(K,{children:e.jsx(M,{children:"Access Control"})}),e.jsx(P,{className:"p-0",children:e.jsxs(Q,{children:[e.jsx(B,{children:e.jsxs(t,{children:[e.jsx(i,{children:"User"}),e.jsx(i,{children:"Email"}),e.jsx(i,{children:"Current Role"}),e.jsx(i,{className:"text-right",children:"Actions"})]})}),e.jsxs(F,{children:[d?e.jsx(t,{children:e.jsx(r,{colSpan:4,className:"h-24 text-center",children:"Loading users..."})}):m.map(s=>e.jsxs(t,{children:[e.jsx(r,{className:"font-medium",children:s.name||"N/A"}),e.jsx(r,{className:"text-sm",children:s.email}),e.jsx(r,{children:e.jsx(b,{variant:s.role==="admin"?"default":"secondary",className:"capitalize",children:s.role})}),e.jsx(r,{className:"text-right",children:e.jsxs(T,{value:s.role,onValueChange:a=>o.mutate({userId:s.id,role:a}),disabled:o.isPending,children:[e.jsx(w,{className:"w-[120px] ml-auto h-8 text-xs",children:e.jsx(R,{})}),e.jsxs(q,{children:[e.jsx(h,{value:"client",children:"Client"}),e.jsx(h,{value:"admin",children:"Admin"})]})]})})]},s.id)),!d&&m.length===0&&e.jsx(t,{children:e.jsx(r,{colSpan:4,className:"h-24 text-center text-muted-foreground",children:"No users found."})})]})]})})]})]})]})}export{Z as default};
