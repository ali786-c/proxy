import{U as f,r as g,i as C,j as e,S as N,a as v,I as y,y as S,z as b,E as w,J as T,K as x,t as h,ae as u}from"./index-BUT0sXTI.js";import{S as E}from"./SEOHead-BCkjpzGJ.js";import{C as R,a as A,b as L,c as U}from"./card-DLfvWdew.js";import{B as q}from"./badge-4qiJzpXv.js";import{T as B,a as H,b as i,c as l,d as I,e as r}from"./table-BPHTtwtd.js";import{u as K}from"./useMutation-B77yjbCU.js";import{R as Q}from"./refresh-cw-bg2_EK0a.js";import{S as z}from"./search-ZkFKJtoo.js";function D(){const d=f(),[n,j]=g.useState(""),{data:p=[],isLoading:c}=C({queryKey:["admin-users-roles"],queryFn:()=>u.get("/admin/users",s=>s)}),o=K({mutationFn:({userId:s,role:a})=>u.post(`/admin/users/${s}/role`,t=>t,{role:a}),onSuccess:()=>{d.invalidateQueries({queryKey:["admin-users-roles"]}),h({title:"Role Updated",description:"User permissions have been modified."})},onError:s=>h({title:"Error",description:s.message,variant:"destructive"})}),m=p.filter(s=>{var a,t;return((a=s.name)==null?void 0:a.toLowerCase().includes(n.toLowerCase()))||((t=s.email)==null?void 0:t.toLowerCase().includes(n.toLowerCase()))});return e.jsxs(e.Fragment,{children:[e.jsx(E,{title:"Admin â€” User Permissions",noindex:!0}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs("h1",{className:"text-2xl font-bold flex items-center gap-2",children:[e.jsx(N,{className:"h-6 w-6"})," User Roles"]}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Manage administrative access for system users."})]}),e.jsx(v,{variant:"ghost",size:"icon",onClick:()=>d.invalidateQueries({queryKey:["admin-users-roles"]}),children:e.jsx(Q,{className:"h-4 w-4"})})]}),e.jsxs("div",{className:"relative max-w-sm",children:[e.jsx(z,{className:"absolute left-3 top-1/2 h-4 w-4 -translate-y-1/2 text-muted-foreground"}),e.jsx(y,{placeholder:"Search by name or email...",value:n,onChange:s=>j(s.target.value),className:"pl-9"})]}),e.jsxs(R,{children:[e.jsx(A,{children:e.jsx(L,{children:"Access Control"})}),e.jsx(U,{className:"p-0",children:e.jsxs(B,{children:[e.jsx(H,{children:e.jsxs(i,{children:[e.jsx(l,{children:"User"}),e.jsx(l,{children:"Email"}),e.jsx(l,{children:"Current Role"}),e.jsx(l,{className:"text-right",children:"Actions"})]})}),e.jsxs(I,{children:[c?e.jsx(i,{children:e.jsx(r,{colSpan:4,className:"h-24 text-center",children:"Loading users..."})}):m.map(s=>e.jsxs(i,{children:[e.jsx(r,{className:"font-medium",children:s.name||"N/A"}),e.jsx(r,{className:"text-sm",children:s.email}),e.jsx(r,{children:e.jsx(q,{variant:s.role==="admin"?"default":"secondary",className:"capitalize",children:s.role})}),e.jsx(r,{className:"text-right",children:e.jsxs(S,{value:s.role,onValueChange:a=>o.mutate({userId:s.id,role:a}),disabled:o.isPending,children:[e.jsx(b,{className:"w-[120px] ml-auto h-8 text-xs",children:e.jsx(w,{})}),e.jsxs(T,{children:[e.jsx(x,{value:"client",children:"Client"}),e.jsx(x,{value:"admin",children:"Admin"})]})]})})]},s.id)),!c&&m.length===0&&e.jsx(i,{children:e.jsx(r,{colSpan:4,className:"h-24 text-center text-muted-foreground",children:"No users found."})})]})]})})]})]})]})}export{D as default};
