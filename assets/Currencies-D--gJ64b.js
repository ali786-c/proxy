import{Q as K,r as l,U as M,j as e,D as U,a as S,I as a,t as w,ae as d,af as H,o as k,aQ as L,aj as j,s as r,ah as P}from"./index-DHWp02IV.js";import{u as g}from"./useMutation-BSQjGnmO.js";import{C as T,a as R,b as _,c as Q}from"./card-eIbDKIKv.js";import{B as t}from"./badge-Cz7CBQXO.js";import{T as I,a as $,b as q,c as n,d as z,e as i}from"./table-CCIcV2D6.js";import{S as O}from"./switch-Bfkou0_n.js";import{S as V}from"./SEOHead-fkmRJ5Qm.js";import{R as G}from"./refresh-cw-CrMBEXHY.js";import{P as J}from"./plus-DjYk-ILR.js";const y=k({id:j().or(r()),code:r(),name:r(),symbol:r(),exchange_rate:j().or(r()),is_active:L().or(j())});function ne(){const c=K(),[o,v]=l.useState(""),[u,N]=l.useState(""),[m,C]=l.useState(""),[x,f]=l.useState("1.0"),{data:D=[],isLoading:F}=M({queryKey:["admin-currencies"],queryFn:()=>d.get("/admin/currencies",P(y))}),b=g({mutationFn:s=>d.post("/admin/currencies",y,s),onSuccess:()=>{c.invalidateQueries({queryKey:["admin-currencies"]}),v(""),N(""),C(""),f("1.0"),w({title:"Currency added"})}}),B=g({mutationFn:({id:s,exchange_rate:h})=>d.put(`/admin/currencies/${s}`,y,{exchange_rate:h}),onSuccess:()=>{c.invalidateQueries({queryKey:["admin-currencies"]}),w({title:"Exchange rate updated"})}}),E=g({mutationFn:s=>d.post(`/admin/currencies/${s}/toggle`,H,{}),onSuccess:()=>{c.invalidateQueries({queryKey:["admin-currencies"]})}}),A=s=>{s.preventDefault(),!(!o||!u||!m||!x)&&b.mutate({code:o.toUpperCase(),name:u,symbol:m,exchange_rate:parseFloat(x),is_active:!0})};return F?e.jsx("div",{className:"p-8 text-center text-muted-foreground",children:"Loading currencies..."}):e.jsxs(e.Fragment,{children:[e.jsx(V,{title:"Admin — Currencies",noindex:!0}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsxs("h1",{className:"text-2xl font-bold flex items-center gap-2",children:[e.jsx(U,{className:"h-6 w-6"})," Currencies"]}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Manage supported currencies and exchange rates."})]}),e.jsxs("div",{className:"grid gap-6 md:grid-cols-3",children:[e.jsxs(T,{className:"md:col-span-2",children:[e.jsxs(R,{className:"flex flex-row items-center justify-between",children:[e.jsx(_,{children:"Supported Currencies"}),e.jsxs(S,{variant:"outline",size:"sm",onClick:()=>c.invalidateQueries({queryKey:["admin-currencies"]}),children:[e.jsx(G,{className:"mr-2 h-4 w-4"})," Refresh"]})]}),e.jsx(Q,{children:e.jsxs(I,{children:[e.jsx($,{children:e.jsxs(q,{children:[e.jsx(n,{children:"Code"}),e.jsx(n,{children:"Symbol"}),e.jsx(n,{className:"text-right",children:"Rate (vs USD)"}),e.jsx(n,{children:"Status"}),e.jsx(n,{})]})}),e.jsx(z,{children:D.map(s=>e.jsxs(q,{children:[e.jsxs(i,{children:[e.jsx("span",{className:"font-bold",children:s.code}),e.jsx("span",{className:"ml-2 text-xs text-muted-foreground",children:s.name})]}),e.jsx(i,{className:"text-lg",children:s.symbol}),e.jsx(i,{className:"text-right",children:e.jsx(a,{type:"number",step:"0.0001",defaultValue:s.exchange_rate,className:"w-24 ml-auto h-8 text-right px-2",onBlur:h=>{const p=parseFloat(h.target.value);p&&p!==s.exchange_rate&&B.mutate({id:s.id,exchange_rate:p})}})}),e.jsx(i,{children:e.jsx(t,{variant:s.is_active?"default":"secondary",children:s.is_active?"Active":"Disabled"})}),e.jsx(i,{children:e.jsx(O,{checked:s.is_active,onCheckedChange:()=>E.mutate(s.id)})})]},s.id))})]})})]}),e.jsxs(T,{children:[e.jsx(R,{children:e.jsx(_,{children:"Add New Currency"})}),e.jsx(Q,{children:e.jsxs("form",{onSubmit:A,className:"space-y-4",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx(t,{variant:"outline",className:"text-[10px] uppercase",children:"Currency Code"}),e.jsx(a,{placeholder:"EUR",value:o,onChange:s=>v(s.target.value),maxLength:3})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx(t,{variant:"outline",className:"text-[10px] uppercase",children:"Display Name"}),e.jsx(a,{placeholder:"Euro",value:u,onChange:s=>N(s.target.value)})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx(t,{variant:"outline",className:"text-[10px] uppercase",children:"Symbol"}),e.jsx(a,{placeholder:"€",value:m,onChange:s=>C(s.target.value)})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx(t,{variant:"outline",className:"text-[10px] uppercase",children:"Rate (Base USD)"}),e.jsx(a,{type:"number",step:"0.0001",value:x,onChange:s=>f(s.target.value)})]})]}),e.jsxs(S,{type:"submit",className:"w-full",disabled:b.isPending,children:[e.jsx(J,{className:"mr-2 h-4 w-4"})," Add Currency"]})]})})]})]})]})]})}export{ne as default};
