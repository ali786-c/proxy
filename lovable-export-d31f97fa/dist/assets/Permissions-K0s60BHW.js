import{j as e,x as g}from"./ui-CeaNA1b8.js";import{S as y}from"./SEOHead-BqhxOP7y.js";import{C,a as N,b as v,c as S}from"./card-clxFFivi.js";import{j as b,k as w,I as T,B as A,e as E,f as L,g as R,h as U,i as h,t as u,y as j,M as q,o as M,s as n,Y as B,C as H}from"./index-CYRX0wpi.js";import{T as I,a as Q,b as t,c as i,d as F,e as r}from"./table-D3uMK-0w.js";import{u as K}from"./useMutation-t07llwxO.js";import{r as P,w as k,a5 as z,ae as V}from"./vendor-CSZBJNtL.js";const O=M({id:B(),name:n().nullable(),email:n(),role:n()});function Z(){const c=b(),[l,p]=P.useState(""),{data:f=[],isLoading:d}=w({queryKey:["admin-users-roles"],queryFn:()=>j.get("/admin/users",H(O))}),o=K({mutationFn:({userId:s,role:a})=>j.post(`/admin/users/${s}/role`,q,{role:a}),onSuccess:()=>{c.invalidateQueries({queryKey:["admin-users-roles"]}),u({title:"Role Updated",description:"User permissions have been modified."})},onError:s=>u({title:"Error",description:s.message,variant:"destructive"})}),m=f.filter(s=>{var a,x;return((a=s.name)==null?void 0:a.toLowerCase().includes(l.toLowerCase()))||((x=s.email)==null?void 0:x.toLowerCase().includes(l.toLowerCase()))});return e.jsxs(e.Fragment,{children:[e.jsx(y,{title:"Admin â€” User Permissions",noindex:!0}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs("h1",{className:"text-2xl font-bold flex items-center gap-2",children:[e.jsx(k,{className:"h-6 w-6"})," User Roles"]}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Manage administrative access for system users."})]}),e.jsx(g,{variant:"ghost",size:"icon",onClick:()=>c.invalidateQueries({queryKey:["admin-users-roles"]}),children:e.jsx(z,{className:"h-4 w-4"})})]}),e.jsxs("div",{className:"relative max-w-sm",children:[e.jsx(V,{className:"absolute left-3 top-1/2 h-4 w-4 -translate-y-1/2 text-muted-foreground"}),e.jsx(T,{placeholder:"Search by name or email...",value:l,onChange:s=>p(s.target.value),className:"pl-9"})]}),e.jsxs(C,{children:[e.jsx(N,{children:e.jsx(v,{children:"Access Control"})}),e.jsx(S,{className:"p-0",children:e.jsxs(I,{children:[e.jsx(Q,{children:e.jsxs(t,{children:[e.jsx(i,{children:"User"}),e.jsx(i,{children:"Email"}),e.jsx(i,{children:"Current Role"}),e.jsx(i,{className:"text-right",children:"Actions"})]})}),e.jsxs(F,{children:[d?e.jsx(t,{children:e.jsx(r,{colSpan:4,className:"h-24 text-center",children:"Loading users..."})}):m.map(s=>e.jsxs(t,{children:[e.jsx(r,{className:"font-medium",children:s.name||"N/A"}),e.jsx(r,{className:"text-sm",children:s.email}),e.jsx(r,{children:e.jsx(A,{variant:s.role==="admin"?"default":"secondary",className:"capitalize",children:s.role})}),e.jsx(r,{className:"text-right",children:e.jsxs(E,{value:s.role,onValueChange:a=>o.mutate({userId:s.id,role:a}),disabled:o.isPending,children:[e.jsx(L,{className:"w-[120px] ml-auto h-8 text-xs",children:e.jsx(R,{})}),e.jsxs(U,{children:[e.jsx(h,{value:"client",children:"Client"}),e.jsx(h,{value:"admin",children:"Admin"})]})]})})]},s.id)),!d&&m.length===0&&e.jsx(t,{children:e.jsx(r,{colSpan:4,className:"h-24 text-center text-muted-foreground",children:"No users found."})})]})]})})]})]})]})}export{Z as default};
